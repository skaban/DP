%DP_costfunction
%this is the cost function used as part of the DP program, at the last time
%step. 
%control variable is P_elec: electric motor power 
%output is fuel power used [W], and ICE Power (to apply constraints)
function [total_cost,P_RTM,P_gen]=DP_costfunction(P_req,P_elec,k,E_state_target,E_final,N_ICE_rpm_k,RTM_Eff_par,RTM_speed_rads_par,regime,limited_regen,P_Gen_opt_map,E_grid,DP_SIM_DATA)

%global limited_regen

% % Define Component Data 
%ICE data%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%regular engine speed and torque indices
ICESpeedIndex_rpm= [0,100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200,6300,6400;];
ICETorqueIndex_Nm = [0;10;20;30;40;50;60;70;80;90;100;110;120;130;140;150;160;170;180;190;200;210;220;];
%engine fuel map data - this is the input power (in W) from the fuel as a
%function ICE torque and speed - must convert this to grams or L of fuel
ICEFuelMap = [0,0,0,0,0,0,5601.34482800000,6580.33505000000,7649.66174200000,8726.76061300000,9700.01426500000,10555.7704200000,11421.5878000000,12499.4827300000,13573.8439400000,14960.1219000000,16395.6912600000,17297.2292000000,18250.7602300000,19642.6129300000,21138.6482200000,22446.6494900000,23791.9830100000,24813.3924000000,25956.4573300000,27023.7131900000,27985.0570500000,28946.4009200000,29907.7447800000,31274.3841700000,32698.6880100000,34134.7786100000,35570.8692100000,37275.5184800000,38980.1677500000,40387.5500700000,41722.2196100000,43073.2836900000,44445.7905700000,46106.2435700000,47766.6965700000,49219.5485800000,50672.4005800000,52125.2525800000,53796.7178600000,55714.1436200000,57631.5693800000,59548.9951300000,61515.4370800000,63686.4019000000,65946.0873400000,68205.7727800000,70465.4582200000,72781.0673200000,75043.5866300000,77258.8609100000,79474.1351800000,82476.8424700000,85479.5497600000,88310.5141300000,90989.9406100000,93482.7690400000,95975.5974700000,98744.1652800000,101540.847700000;0,0,0,0,0,0,5601.34482800000,6580.33505000000,7649.66174200000,8726.76061300000,9700.01426500000,10555.7704200000,11421.5878000000,12499.4827300000,13573.8439400000,14960.1219000000,16395.6912600000,17297.2292000000,18250.7602300000,19642.6129300000,21138.6482200000,22446.6494900000,23791.9830100000,24813.3924000000,25956.4573300000,27023.7131900000,27985.0570500000,28946.4009200000,29907.7447800000,31274.3841700000,32698.6880100000,34134.7786100000,35570.8692100000,37275.5184800000,38980.1677500000,40387.5500700000,41722.2196100000,43073.2836900000,44445.7905700000,46106.2435700000,47766.6965700000,49219.5485800000,50672.4005800000,52125.2525800000,53796.7178600000,55714.1436200000,57631.5693800000,59548.9951300000,61515.4370800000,63686.4019000000,65946.0873400000,68205.7727800000,70465.4582200000,72781.0673200000,75043.5866300000,77258.8609100000,79474.1351800000,82476.8424700000,85479.5497600000,88310.5141300000,90989.9406100000,93482.7690400000,95975.5974700000,98744.1652800000,101540.847700000;0,0,0,0,0,0,7224.53255000000,8298.57996000000,9492.10160200000,10723.7019000000,11795.7351500000,12799.7009300000,14291.2493100000,15508.0468300000,16715.3304700000,18283.7580800000,19863.6108400000,21206.0307100000,22652.0399700000,23997.3543200000,25333.7834900000,26875.4940500000,28254.0181700000,29748.8645400000,31288.5259800000,32508.6110100000,33728.6960400000,34948.7810700000,36168.8661000000,37623.7206100000,39078.5751100000,40533.4296200000,41988.2841300000,43926.8777500000,45865.4713700000,47721.2898400000,49480.9503500000,51274.7365600000,53068.5227700000,54981.7955300000,56917.7445600000,58691.9767000000,60466.2088300000,62240.4409600000,64214.1621300000,66399.8161100000,68585.4701000000,70744.2692200000,72879.6786400000,75180.3217800000,77480.9649300000,79811.4551800000,82146.9900200000,84678.4842200000,87144.9654300000,89611.4466500000,92077.9278600000,95248.9837100000,98420.0395700000,101523.903400000,104607.344100000,108119.653700000,111631.963300000,114708.594700000,117505.277100000;0,0,0,0,0,0,9424.68628200000,10487.4241900000,11668.1423900000,12891.9300500000,14248.4551600000,15695.7096600000,17160.9108200000,18647.6747600000,20192.7092900000,21904.5257300000,23626.7412700000,25309.4976600000,26968.0120100000,28528.5541800000,30064.3625200000,32070.3910200000,33853.6626000000,35300.1816900000,36762.3083100000,38276.3191500000,39639.4207200000,41002.5222900000,42365.6238500000,44131.7569800000,45842.1402300000,47529.4271000000,49216.7139800000,51353.4847000000,53490.2554100000,55573.9631800000,57567.8176800000,59586.8834100000,61696.4041200000,63927.7375300000,66159.0709400000,68349.3483000000,70539.6256500000,72729.9030000000,74794.9546400000,77129.6668200000,79560.5142400000,81991.3616700000,84422.2091000000,86991.7875300000,89561.3659500000,92099.2969800000,94434.8318100000,97144.6895700000,99854.5473200000,102564.405100000,105210.094200000,108699.723500000,112435.781200000,116171.838900000,119907.896600000,124601.636000000,128587.434100000,131956.713700000,135325.993300000;0,0,0,0,0,0,11751.0068100000,12970.3002000000,14367.3071900000,15780.6482300000,17191.1005200000,18707.5912800000,20200.6526800000,21960.3012200000,23679.0618500000,25534.2399800000,27309.0506400000,29186.6368600000,31204.6558900000,32983.1977700000,34672.5606300000,36837.8151300000,38937.8982800000,40505.8718400000,42217.6132000000,44152.2921600000,45809.5915100000,47413.1271400000,49016.6627800000,50900.2475200000,52783.8322600000,54624.8053100000,56454.3737600000,58599.0830100000,61032.4180400000,63465.7530800000,65899.0881100000,68196.7797400000,70494.4713700000,72877.8293200000,75599.0933100000,78196.2113400000,80793.3293800000,83224.2309200000,85592.5353800000,88113.5939600000,90676.0789200000,93382.0406300000,96088.0023300000,98990.2481100000,101857.620800000,104509.752100000,107161.883400000,110489.432800000,113816.982300000,116750.004700000,119618.426200000,123888.690400000,128158.954500000,132429.218700000,136282.541200000,140976.280700000,145670.020100000,150363.759600000,154826.206900000;0,0,0,0,0,0,13848.5167300000,15444.0235700000,16949.6415500000,18335.2468900000,19782.0283600000,21146.3391700000,22542.4283100000,24501.8507800000,26555.5519400000,28873.4297900000,30931.2062000000,33078.8187300000,35275.5339000000,37259.3314400000,39251.7583100000,41535.4550700000,43815.7665800000,45638.0884000000,47774.8086600000,49948.5673800000,51969.2520900000,53908.6978700000,55848.1436500000,58115.7014100000,60209.0938800000,62231.5114800000,64253.9290800000,66768.8197500000,69283.7104100000,71798.6010800000,74314.9052800000,77020.6855300000,79726.4657700000,82432.2460200000,85188.1996000000,88018.2382200000,90776.5266100000,93534.8150100000,96293.1034000000,99095.7047800000,101898.306200000,104867.223600000,107887.737500000,111271.592000000,114225.555200000,117179.518300000,120133.481500000,124559.862900000,128278.693900000,131540.057000000,134801.420100000,139512.844100000,144022.971500000,148476.318400000,152929.665300000,158772.727000000,164575.141500000,169380.388500000,174185.635400000;0,0,0,0,0,0,15290.4835300000,17545.8640200000,19536.5811700000,20860.9554400000,22092.6715300000,23636.8603600000,25158.6527100000,27425.0710600000,29745.1408500000,32254.7239700000,34727.8519900000,37092.1568900000,39328.6392200000,41609.6119400000,43865.5504200000,46287.4755400000,48725.4637800000,51191.0699200000,53697.9842900000,55911.9641700000,58102.9954000000,60293.4696200000,62483.9438400000,64765.3853300000,67166.2589600000,69609.8801600000,72053.5013600000,74660.2406800000,77266.9800000000,79849.5117600000,82406.2093700000,85749.5802300000,88658.6571500000,91567.7340700000,94476.8109900000,97403.3062700000,100329.801600000,103616.374500000,106950.589600000,110226.184200000,113501.778800000,116607.408900000,119627.922800000,123067.356100000,126506.789300000,129946.222600000,133101.927600000,137528.309100000,141954.690500000,146381.071900000,150816.810700000,155531.076600000,160242.500700000,164953.924800000,169655.443200000,175660.207500000,181724.941000000,187789.674600000,193854.408100000;0,0,0,0,0,0,16712.9395000000,18976.6615700000,21432.7785000000,22725.8612800000,24050.2807500000,26066.1814100000,28111.0452200000,30640.8666400000,33161.3695400000,35817.9575200000,38535.3396500000,41080.0588400000,43483.0988800000,45929.6350100000,48549.2898000000,51243.4448800000,53912.1446300000,56628.8773200000,59380.9177200000,61678.2380300000,63975.5583300000,66288.1477100000,68902.3404800000,71465.5008100000,74028.6611400000,76591.8214700000,79264.0415000000,82217.6733500000,85050.7034400000,87883.7335300000,90716.7636100000,94265.2897200000,97565.1145200000,100764.949800000,103964.785000000,107362.909700000,110761.034400000,114159.159100000,117663.629500000,121130.458000000,124556.565400000,127982.672800000,131408.780300000,134851.012700000,138427.761100000,142248.609400000,146069.457700000,151595.231900000,156996.958100000,161560.775500000,166124.593000000,172291.905800000,178459.218600000,183767.279800000,188466.005200000,195267.699600000,202069.394100000,208798.965000000,214863.698500000;0,0,0,0,0,0,18002.6388600000,20557.8843500000,23066.3054800000,24482.6447200000,26439.3111700000,28903.5474000000,31036.8250400000,33602.6944600000,36601.3885700000,39387.8312200000,42350.5384100000,44903.0767400000,47746.8645800000,50713.2933100000,53368.3587300000,56047.3474400000,58743.8972100000,61695.9438100000,65198.7929000000,67550.6456400000,69902.4983700000,72823.9886400000,75926.3666100000,78489.5269400000,81052.6872700000,83615.8476000000,87270.5874800000,90757.6919800000,94143.7517600000,96976.7818400000,99809.8119300000,103358.338000000,106906.864100000,110455.390200000,113785.030100000,117244.591000000,121136.720300000,125028.849700000,128920.979000000,132431.142500000,135992.541600000,139585.904100000,143179.266500000,147084.734900000,150990.203300000,154895.671700000,159102.317100000,165290.101200000,170747.825100000,176205.549000000,181663.272900000,188375.235800000,194776.512800000,201177.789700000,207579.066700000,216604.671600000,224605.028900000,231952.645300000,239300.261700000;0,0,0,0,0,0,19290.1795700000,21929.4624100000,24744.2402900000,27025.8134700000,28982.4799300000,31509.2730600000,33962.6048700000,36954.5523100000,40046.1428400000,43115.6456200000,46210.0327900000,48954.5731900000,52070.1320700000,55433.2019500000,58187.4276600000,60866.4163600000,63545.6133100000,67348.3178800000,71164.9963000000,73643.2588500000,76745.6368100000,79848.0147700000,82950.3927300000,85513.5530600000,88076.7133900000,91494.4203600000,95277.1334600000,98764.2379500000,102251.342500000,105738.446900000,108902.860200000,112451.386400000,116135.509300000,119852.013600000,123568.517800000,127439.791500000,131575.258400000,135884.338100000,140193.417700000,143933.951400000,147674.485100000,151313.304200000,154906.666600000,158812.135000000,163222.471200000,167818.665300000,172414.859400000,179486.400600000,186557.941800000,193360.513400000,198818.237300000,206004.306800000,213190.376300000,220376.445800000,227219.518100000,236245.123000000,245993.556300000,255831.934400000,265670.312400000;0,0,0,0,0,0,20821.2746800000,23497.1651200000,26487.1461700000,28952.3796800000,31530.7141500000,34298.0021500000,37000.0467300000,40466.4161000000,43563.0744000000,46782.5052100000,50090.4852600000,53277.8406700000,56393.3995500000,59756.4694300000,63006.4965800000,66063.3952300000,69347.0398300000,73207.8296600000,77072.8740000000,80667.2849700000,83769.6629400000,86872.0409000000,89974.4188600000,92537.5791900000,95718.2532500000,99500.9663400000,103283.679400000,106770.783900000,110257.888400000,113765.012900000,117992.856700000,121727.692700000,125462.528700000,129197.364700000,133408.430600000,137835.163800000,142261.896900000,146688.630000000,151484.090000000,155645.491800000,159454.283200000,163263.074700000,167071.866100000,171679.114700000,176286.363300000,180957.002800000,186318.384800000,194310.688100000,201812.163000000,209033.064100000,216253.965200000,225597.733200000,234709.076600000,242454.925600000,250200.774700000,260650.951500000,271101.128300000,281551.305100000,291852.197700000;0,0,0,0,0,0,22645.2788300000,25291.5360200000,28256.6169100000,31202.5643100000,34111.4049300000,37354.2450000000,40064.0221300000,43574.7751400000,47084.6130200000,50569.2487900000,54054.7700600000,57246.2537700000,60912.3665800000,64274.8068000000,67950.8541000000,71876.9639800000,75160.6085800000,79022.9238100000,82896.8196200000,86678.4431500000,90460.0666800000,93896.0670300000,96998.4449900000,99942.0861300000,103724.799200000,107507.512300000,111290.225400000,114777.329900000,118625.876200000,122853.720100000,127081.563900000,130816.399900000,134812.562000000,139055.043100000,143297.524300000,147724.257400000,152426.815500000,157620.169200000,162813.522800000,167056.879000000,171300.235100000,175543.591300000,179778.683100000,185126.949800000,190488.331800000,195849.713800000,201211.095900000,209203.399100000,217280.948300000,225358.960700000,233436.973100000,243018.740400000,252974.982900000,262931.225400000,272887.467900000,284320.644300000,294808.549300000,305296.454300000,315784.359200000;0,0,0,0,0,0,24357.1419300000,27212.8205700000,30349.0604700000,33546.9434300000,36692.0957000000,39934.9357700000,43127.9975300000,46850.8330200000,50622.4830200000,54320.1293700000,58019.7521300000,61754.1935100000,65487.4996300000,69187.9205400000,72932.2139500000,77001.4637500000,80974.1773300000,84846.8694200000,88720.7652400000,92502.3887700000,96284.0123000000,100065.635800000,103961.836200000,107943.911900000,111728.745000000,115513.578100000,119296.771400000,123486.739600000,127713.357700000,131938.723500000,136164.089300000,140390.925200000,144617.761100000,148844.597000000,153225.920100000,158562.894600000,163756.248300000,168949.602000000,174142.955700000,178386.311800000,182789.842500000,187402.866900000,192015.891300000,197251.374400000,202486.857600000,208647.346100000,216109.979700000,226628.533500000,235737.860900000,244186.038700000,252634.216500000,263717.816300000,274468.146200000,284424.388700000,294380.631200000,306165.402400000,317950.173700000,329095.157600000,339583.062500000;0,0,0,0,0,0,26069.0050200000,29177.0635400000,32526.1095800000,35957.8715500000,39320.8243800000,42563.7990900000,46240.1660300000,50388.7357500000,54160.3857500000,57858.0320900000,62216.4628800000,65970.7714300000,70165.0005100000,73940.1891700000,77891.6444900000,82272.7012000000,86379.7611200000,90519.3356900000,94544.7108600000,98408.7355300000,102462.675200000,106516.614900000,110570.554500000,114913.003400000,119255.452300000,123473.273600000,127258.106700000,131821.385600000,136384.664600000,140920.849100000,145146.214900000,149390.080900000,154068.214000000,158746.347000000,163424.480000000,168834.678600000,174244.877200000,179712.758500000,185320.853200000,190747.067300000,195024.216000000,199637.240400000,204250.264800000,209814.660200000,217277.293800000,224739.927400000,232202.561100000,242721.114900000,253239.668800000,263621.980700000,272070.158500000,283153.758200000,294237.358000000,305320.957700000,315873.794400000,327658.565600000,339443.336900000,351528.392900000,363878.565000000;0,0,0,0,0,0,27780.8681200000,31141.3065000000,38315.3378500000,38515.7324900000,41955.3693100000,45620.1404800000,49357.8684100000,53560.4338700000,57698.2884800000,62005.0028300000,66413.1736200000,70606.9095100000,74854.8957000000,78764.3580800000,82840.7553700000,87431.3390200000,91731.8084400000,95880.9284100000,100391.769300000,104530.377000000,108668.984700000,112807.592400000,117258.542700000,121612.920600000,125967.298500000,130321.676300000,135180.314700000,140222.984000000,144962.793400000,149566.286800000,154169.780200000,158962.536000000,163755.291700000,168548.047400000,173582.326500000,179405.070300000,185013.165000000,190621.259800000,196229.354500000,201655.568600000,207081.782800000,212507.997000000,218872.724500000,226316.071900000,233759.419300000,241202.766700000,248295.142500000,258813.696300000,269583.432400000,280366.358500000,291149.284600000,303814.256400000,315177.238400000,326540.220500000,337903.202500000,352709.799100000,366081.918900000,378432.091100000,390782.263200000;0,0,0,0,0,0,29492.7312100000,33105.5494700000,44104.5661200000,41073.5934400000,44823.7694100000,48687.5049000000,52570.6404700000,57489.8393400000,62006.4407600000,66492.9214500000,70922.1556000000,75208.1406600000,79622.3255500000,83705.9800700000,87781.3204200000,92373.6475600000,97318.9884200000,101735.365900000,106246.206800000,110384.814500000,114918.651900000,119521.224900000,124123.797900000,128478.175700000,133278.747800000,138171.512900000,143064.278000000,148106.947300000,153149.616500000,158192.285800000,163216.353200000,168304.112400000,173407.644600000,178511.176700000,183614.708800000,190185.428100000,196756.147300000,201529.761100000,207137.855800000,212564.069900000,219062.381500000,225563.547400000,232064.713300000,239508.060700000,246951.408200000,254604.606400000,264454.540700000,276570.417200000,287969.916000000,298752.842000000,309535.768100000,323324.663500000,337113.558800000,348756.085700000,360119.067700000,374925.664400000,389732.261000000,404538.857700000,417685.961400000;0,0,0,0,0,0,31204.5943000000,35069.7924300000,49893.7943900000,43631.4543800000,47692.1695000000,57416.8450000000,55942.5398700000,61401.0471000000,66454.8039400000,71031.7254500000,77055.6999600000,80633.5640300000,84530.0147200000,89366.8377200000,94793.2545800000,98321.4967400000,103510.795300000,107885.319500000,112251.742000000,116870.216500000,121488.691000000,126318.949100000,131168.989000000,136212.297100000,141162.711100000,146055.476200000,150948.241400000,155990.910600000,161285.487900000,167144.703300000,173003.918800000,178300.124700000,183440.026900000,188543.559000000,193647.091200000,200217.810400000,206788.529600000,213359.248900000,221053.155800000,227373.348900000,232254.370300000,238755.536200000,245256.702100000,252700.049600000,260923.268000000,270773.202300000,280623.136600000,292739.013100000,304854.889600000,316970.766100000,327922.251600000,341711.147000000,355500.042300000,369288.937700000,382334.932900000,397293.392100000,414093.183900000,430892.975800000,447692.767700000;0,0,0,0,0,0,32916.4574000000,37034.0354000000,55683.0226500000,46189.3153300000,50560.5695900000,66146.1851100000,70767.6374600000,69288.0090900000,73963.1081000000,79328.6338600000,85352.6083600000,88930.4724400000,93707.4519500000,100546.801900000,105973.218800000,109204.665600000,112552.817100000,117015.792000000,122002.952500000,126622.750300000,131242.548100000,135862.345900000,141196.957900000,143843.987800000,148863.380200000,153882.772500000,158902.164900000,165225.886700000,171085.102100000,176944.317500000,182803.533000000,188099.738900000,193395.944900000,198575.941400000,203679.473500000,210250.192800000,216995.892800000,225223.018300000,233450.143700000,239770.336900000,246090.530000000,252410.723100000,258448.691000000,267241.929700000,277091.864000000,286941.798300000,296791.732600000,309251.173700000,321928.277000000,334605.380200000,347282.483400000,364523.070800000,378968.542000000,393414.013100000,407859.484300000,426423.301200000,444987.118200000,462600.246800000,479400.038600000;0,0,0,0,0,0,34628.3204900000,38998.2783600000,61472.2509200000,48747.1762700000,53428.9696800000,74875.5252200000,85592.7350500000,77174.9710800000,83315.2228600000,87752.6946300000,93649.5167700000,97573.4831500000,103327.887300000,111018.740100000,117153.183000000,120443.195100000,123945.746200000,128408.721000000,134291.925500000,138911.723300000,143531.521100000,148946.303400000,155277.445200000,156143.716900000,157009.988500000,162017.489300000,167036.881700000,173623.241000000,180209.600400000,186743.931700000,192603.147200000,197899.353100000,203195.559100000,208491.765100000,213711.855900000,221165.755300000,229392.880800000,237620.006200000,245847.131700000,252167.324800000,258487.518000000,265369.730600000,275306.608400000,284080.346900000,294000.886400000,303921.426000000,313841.965600000,328330.404100000,342364.756700000,355041.860000000,367718.963200000,385189.044300000,402659.125400000,419734.948000000,434180.419200000,452744.236100000,471308.053100000,497083.258500000,524210.102400000;0,0,0,0,0,0,36340.1835900000,40962.5213300000,67261.4791900000,51305.0372100000,56297.3697700000,83604.8653200000,100417.832600000,85061.9330600000,92667.3376100000,96176.7554000000,101946.425200000,107193.918500000,112948.322700000,120639.175400000,128318.321300000,131836.124200000,135338.675300000,140584.792500000,146580.898500000,151200.696300000,156695.648800000,163026.790700000,169357.932600000,170224.204200000,171090.475800000,171956.747500000,175171.598500000,181757.957800000,188199.458100000,194295.728600000,200391.999100000,206545.955800000,214065.133200000,221584.310600000,229103.488000000,235565.649000000,242027.810000000,250016.994200000,258244.119700000,264564.312800000,274308.451900000,284245.329600000,294182.207400000,302895.049900000,311607.892300000,321019.038900000,330939.578400000,345428.017000000,359916.455500000,374404.894000000,388155.443000000,405625.524100000,425860.603400000,447799.368400000,469738.133500000,495659.232400000,520041.310300000,531566.270300000,569020.166300000;0,0,0,0,0,0,38052.0466800000,42926.7642900000,73050.7074600000,53862.8981600000,59165.7698600000,92334.2054300000,115242.930200000,92948.8950500000,102019.452400000,104600.816200000,110243.333600000,116814.353900000,122568.758100000,130259.610800000,139483.459600000,141568.438300000,147230.322200000,152873.765500000,158869.871500000,164444.994300000,170776.136200000,177107.278000000,183438.419900000,184304.691500000,185252.618700000,187575.081700000,189897.544800000,203489.227500000,216002.904700000,224151.875500000,232300.846400000,237261.994700000,242223.143000000,247157.381900000,251430.614100000,252045.787800000,258105.996200000,264171.470700000,270236.945100000,281169.677900000,292102.410600000,303035.143400000,313057.806400000,321770.648900000,330483.491300000,339196.333800000,348037.191300000,366218.809800000,386289.657100000,406360.504500000,426431.351800000,447990.647400000,468613.802700000,475863.788900000,505295.847800000,538574.228600000,568774.567500000,566049.282100000,613830.230100000;0,0,0,0,0,0,39763.9097800000,44891.0072600000,78839.9357200000,56420.7591000000,62034.1699500000,101063.545500000,130068.027800000,100835.857000000,111371.567100000,113024.876900000,118540.242000000,126434.789300000,132189.193500000,139880.046200000,150648.597900000,151300.752400000,159121.969100000,165162.738500000,171158.844500000,177689.292300000,184856.623500000,191187.765300000,192122.487400000,198926.446400000,204281.929700000,206604.392800000,208926.855800000,222518.538500000,236110.221200000,247776.115800000,252836.457800000,257896.799700000,263164.105400000,273372.668900000,283581.232500000,293297.671000000,294133.985100000,294970.299300000,295806.613400000,300566.078300000,305325.543100000,315390.473500000,326538.151900000,335512.657400000,345195.990700000,354879.324000000,364562.657400000,386201.630500000,427756.071000000,438316.114900000,464707.260600000,490355.770800000,511367.002000000,503928.209300000,540853.562100000,581489.224900000,617507.824700000,600532.293800000,658640.293900000;0,0,0,0,0,0,41475.7728700000,46855.2502200000,84629.1639900000,58978.6200500000,64902.5700500000,109792.885600000,144893.125400000,108722.819000000,120723.681900000,121448.937700000,126837.150400000,136055.224700000,141809.628900000,149500.481600000,161813.736200000,161033.066500000,171013.616100000,177451.711500000,183447.817500000,190933.590300000,198937.110800000,205268.252600000,200806.555000000,213548.201400000,223311.240800000,225633.703800000,227956.166800000,241547.849500000,256217.537700000,271400.356200000,273372.069200000,278531.604800000,284105.067700000,299587.955900000,315731.850900000,334549.554200000,330161.974000000,325769.127900000,321376.281700000,319962.478700000,318548.675600000,327745.803600000,340018.497400000,349254.665900000,359908.490100000,370562.314300000,381088.123500000,406184.451200000,469222.484900000,470271.725300000,502983.169400000,532720.894200000,554120.201300000,531992.629700000,576411.276300000,624404.221100000,666241.081900000,635015.305600000,703450.357700000;];
%ICE max torque as function of speed
ICE_max_spd_index_rads=[62.8318530717959,68.0678408277789,83.7758040957278,104.719755119660,125.663706143592,146.607657167524,167.551608191456,188.495559215388,209.439510239320,230.383461263252,251.327412287183,293.215314335047,335.103216382911,376.991118430775,418.879020478639,460.766922526503,502.654824574367,544.542726622231,586.430628670095,628.318530717959,670.206432765823;];
ICE_max_trq_index=[123,129,136,150,161,185,193,193,189,198,204,205,215,207,207,216,217,214,204,196,183;];

EngSpd_rpm=N_ICE_rpm_k;
EngSpd_rads=EngSpd_rpm*(pi/30);

%ICE_Max_Torque_Nm=interp1(ICE_max_spd_index_rads,ICE_max_trq_index,EngSpd_rads,'nearest');

ICE_max_spd_index_rads=[0,62.8318530717959,68.0678408277789,83.7758040957278,104.719755119660,125.663706143592,146.607657167524,167.551608191456,188.495559215388,209.439510239320,230.383461263252,251.327412287183,293.215314335047,335.103216382911,376.991118430775,418.879020478639,460.766922526503,502.654824574367,544.542726622231,586.430628670095,628.318530717959,670.206432765823;];
Gen_Max_Torque_index=[0,123,129,136,150,161,185,193,193,189,198,204,205,215,207,190.137105347117,171.123394812406,160.428182636630,146.677195553491,135.097416957163,128.342546109304,107.856000000000;];
Gen_max_torque=interp1(ICE_max_spd_index_rads,Gen_Max_Torque_index,EngSpd_rads,'nearest');

%RTM Data%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%speed and torque indices
RTMSpeedIndex_rpm=[0,250.8,501.3,802.3,1003.3,1494.3,2004.9,2497,2997.6,3499.4,4001.6,4502.5,5005,5504.4,6006.5,6507.1,7009.4,7510.3,8006,8502.4,8813.5];
%RTM efficiency map data

RTM_max_spd_index_rads=[0,26.2637145840107,52.4960132414854,84.0166595325030,105.065330311555,156.482730075308,209.952637039406,261.485228533790,313.907937946692,366.456311065737,419.046572086831,471.500697426268,524.122374373897,576.419420080655,628.999209126236,681.421918539138,734.022651535743,786.476776875181,838.386359487996,890.369245929395,922.947561747121;].*(30/pi);
RTM_max_trq_index=[250,250,250,250,250,250,250,250,250,250,220,205,180,165,145,135,120,110,100,90,85;];
RTM_Max_Torque_Nm=interp1(RTM_max_spd_index_rads,RTM_max_trq_index,RTM_speed_rads_par,'nearest');
RTM_Max_Torque_Nm=350;
%BAS Data%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
P_BAS_max=80000; %80kW peak, 37kW continuous, %quantized to 72kW for coarse search
P_gen_max=P_BAS_max;
P_Gen_opt_map=[100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200,6300,6400,6500,6600,6700,6800,6900,7000,7100,7200,7300,7400,7500,7600,7700,7800,7900,8000,8100,8200,8300,8400,8500,8600,8700,8800,8900,9000,9100,9200,9300,9400,9500,9600,9700,9800,9900,10000,10100,10200,10300,10400,10500,10600,10700,10800,10900,11000,11100,11200,11300,11400,11500,11600,11700,11800,11900,12000,12100,12200,12300,12400,12500,12600,12700,12800,12900,13000,13100,13200,13300,13400,13500,13600,13700,13800,13900,14000,14100,14200,14300,14400,14500,14600,14700,14800,14900,15000,15100,15200,15300,15400,15500,15600,15700,15800,15900,16000,16100,16200,16300,16400,16500,16600,16700,16800,16900,17000,17100,17200,17300,17400,17500,17600,17700,17800,17900,18000,18100,18200,18300,18400,18500,18600,18700,18800,18900,19000,19100,19200,19300,19400,19500,19600,19700,19800,19900,20000,20100,20200,20300,20400,20500,20600,20700,20800,20900,21000,21100,21200,21300,21400,21500,21600,21700,21800,21900,22000,22100,22200,22300,22400,22500,22600,22700,22800,22900,23000,23100,23200,23300,23400,23500,23600,23700,23800,23900,24000,24100,24200,24300,24400,24500,24600,24700,24800,24900,25000,25100,25200,25300,25400,25500,25600,25700,25800,25900,26000,26100,26200,26300,26400,26500,26600,26700,26800,26900,27000,27100,27200,27300,27400,27500,27600,27700,27800,27900,28000,28100,28200,28300,28400,28500,28600,28700,28800,28900,29000,29100,29200,29300,29400,29500,29600,29700,29800,29900,30000,30100,30200,30300,30400,30500,30600,30700,30800,30900,31000,31100,31200,31300,31400,31500,31600,31700,31800,31900,32000,32100,32200,32300,32400,32500,32600,32700,32800,32900,33000,33100,33200,33300,33400,33500,33600,33700,33800,33900,34000,34100,34200,34300,34400,34500,34600,34700,34800,34900,35000,35100,35200,35300,35400,35500,35600,35700,35800,35900,36000,36100,36200,36300,36400,36500,36600,36700,36800,36900,37000,37100,37200,37300,37400,37500,37600,37700,37800,37900,38000,38100,38200,38300,38400,38500,38600,38700,38800,38900,39000,39100,39200,39300,39400,39500,39600,39700,39800,39900,40000,40100,40200,40300,40400,40500,40600,40700,40800,40900,41000,41100,41200,41300,41400,41500,41600,41700,41800,41900,42000,42100,42200,42300,42400,42500,42600,42700,42800,42900,43000,43100,43200,43300,43400,43500,43600,43700,43800,43900,44000,44100,44200,44300,44400,44500,44600,44700,44800,44900,45000,45100,45200,45300,45400,45500,45600,45700,45800,45900,46000,46100,46200,46300,46400,46500,46600,46700,46800,46900,47000,47100,47200,47300,47400,47500,47600,47700,47800,47900,48000,48100,48200,48300,48400,48500,48600,48700,48800,48900,49000,49100,49200,49300,49400,49500,49600,49700,49800,49900,50000,50100,50200,50300,50400,50500,50600,50700,50800,50900,51000,51100,51200,51300,51400,51500,51600,51700,51800,51900,52000,52100,52200,52300,52400,52500,52600,52700,52800,52900,53000,53100,53200,53300,53400,53500,53600,53700,53800,53900,54000,54100,54200,54300,54400,54500,54600,54700,54800,54900,55000,55100,55200,55300,55400,55500,55600,55700,55800,55900,56000,56100,56200,56300,56400,56500,56600,56700,56800,56900,57000,57100,57200,57300,57400,57500,57600,57700,57800,57900,58000,58100,58200,58300,58400,58500,58600,58700,58800,58900,59000,59100,59200,59300,59400,59500,59600,59700,59800,59900,60000,60100,60200,60300,60400,60500,60600,60700,60800,60900,61000,61100,61200,61300,61400,61500,61600,61700,61800,61900,62000,62100,62200,62300,62400,62500,62600,62700,62800,62900,63000,63100,63200,63300,63400,63500,63600,63700,63800,63900,64000,64100,64200,64300,64400,64500,64600,64700,64800,64900,65000,65100,65200,65300,65400,65500,65600,65700,65800,65900,66000,66100,66200,66300,66400,66500,66600,66700,66800,66900,67000,67100,67200,67300,67400,67500,67600,67700,67800,67900,68000,68100,68200,68300,68400,68500,68600,68700,68800,68900,69000,69100,69200,69300,69400,69500,69600,69700,69800,69900,70000,70100,70200,70300,70400,70500,70600,70700,70800,70900,71000,71100,71200,71300,71400,71500,71600,71700,71800,71900,72000,72100,72200,72300,72400,72500,72600,72700,72800,72900,73000,73100,73200,73300,73400,73500,73600,73700,73800,73900,74000,74100,74200,74300,74400,74500,74600,74700,74800,74900,75000,75100,75200,75300,75400,75500,75600,75700,75800,75900,76000,76100,76200,76300,76400,76500,76600,76700,76800,76900,77000,77100,77200,77300,77400,77500,77600,77700,77800,77900,78000,78100,78200,78300,78400,78500,78600,78700,78800,78900,79000,79100,79200,79300,79400,79500,79600,79700,79800,79900,80000;1000.01168520583,1000.01168395207,1000.01168056538,1000.01446672521,1000.01491763095,1000.02032459932,1000.00043082438,1000.01695048935,1000.01790588653,1000.01765485812,1000.01841458454,1000.01831741188,1000.02079504838,1000.02245837162,1000.02223210702,1000.02052467820,1000.00003399783,1000.69844410930,1000.00002021619,1000.23808339795,3175.70668901404,3175.67734937193,3176.18084408973,3176.17856824358,3176.17327193588,3176.16515860471,3176.15442097814,3176.14123644302,3176.59561717070,3176.60387042963,3176.60977532395,3176.61343953376,3176.61496344301,3176.97009946300,3176.98613261842,3177.00022258292,3177.01243409381,3177.02282961617,3177.03147089869,3177.40341655813,3177.42578103382,3177.44656813301,3177.46581622148,3177.48356409456,3177.64448315746,3177.83254982581,3177.85971524991,3177.88557633308,3177.91015762811,3177.93348329440,3178.64412834579,3178.61102729072,3178.57712873171,3178.54244778997,3178.50699785212,3178.47079369619,3178.70706522208,3178.67769237115,3178.64763071338,3178.61689034335,3178.58548133415,3178.80076506909,3178.77514835695,3178.74892171070,3178.72209347978,3178.69466987258,3178.66665751918,3178.87045383421,3178.84747841413,3178.82396567728,3178.79992004574,3178.77534736109,3178.85667647887,3178.94381147336,3178.92335143211,3178.90241752667,3178.88101382624,3178.85914249187,3179.03863335872,3179.02056729011,3179.02403023284,3179.03512134753,3179.04571721139,3179.05582099612,3179.26136347221,3179.27650378645,3179.29121826274,3179.30550894451,3179.31937882986,3179.43857765431,3179.57140046703,3179.60087440744,3179.63018975354,3179.65934652494,3179.68834590160,3179.80525823168,3179.80848891733,3179.81109411093,3179.81307713953,3179.81444044752,3179.81518453951,3180.03112637105,3180.04942952847,3180.06739118297,3180.08501136293,3180.10229177041,3180.27763409377,3180.29856991462,3180.31921087411,3180.33955572259,3180.35960527283,3181.06541576560,3181.22764360319,3181.23780426114,3181.24769287550,3181.25731023752,3181.26665655033,3181.35073748926,3181.43325212490,3181.44481215711,3181.45612522937,3181.46719369374,3181.47801616353,3181.62987382739,3181.64287470403,3181.65565041501,3181.66820039788,3181.68052607944,3181.69262663661,3181.84131604828,3181.85525553167,3181.86898541885,3181.88250578511,3181.89581623078,3181.97577736175,3182.05428436971,3182.06930062661,3182.08412344377,3182.09875351333,3182.11318950181,3182.25447772574,3182.21674465929,3182.15518038173,3182.09352056310,3182.03176474065,3182.03131302967,3182.03074619363,3181.97017830276,3181.90952864141,3181.84879754046,3181.78798589648,3181.78905728776,3181.79159111991,3181.73357991056,3181.67552280964,3181.61742083110,3181.55927378426,3181.61122799162,3181.55345483451,3181.49563897926,3181.43778234051,3181.37988645888,3181.38454996692,3181.39073783327,3181.33104528582,3181.27128928987,3181.21146955383,3181.15159026690,3181.37816893396,3181.27546090269,3181.17213210236,3179.94836101387,3179.90278313876,3179.85645623375,3179.55793391382,3179.60481897788,3179.65210689492,3179.69979915973,3179.74789431765,3179.93138882282,3180.11110237290,3180.11318256335,3180.11510743944,3180.11687428055,3180.11848132003,3180.21822899910,3180.22373333631,3180.22911408454,3180.23436873217,3180.23949334412,3180.29190160272,3180.35066936036,3180.35381304204,3180.35679256499,3180.35960539196,3180.36224780530,3180.40767847782,3180.45997548973,3180.46271939336,3180.46528160668,3180.46765533138,3180.46983734875,3182.03426000218,3181.80535085109,3181.58104273815,3181.36173286978,3181.14782684681,3180.97790836834,3180.82829272150,3180.63288864325,3180.44450270253,3180.26352731415,3180.09035006074,3180.02899584691,3179.87556205418,3179.73101459466,3179.59565189347,3179.46980094330,3179.35371923577,3179.52526289448,3179.45971816123,3179.40462739143,3179.36013842654,3179.32635047090,3179.23098386348,3178.93872262586,3178.86959993799,3178.81122211239,3178.76349680253,3109.55852699551,3179.15448231353,3179.14043482934,3177.09759912604,3177.09643271661,3177.09390605799,3177.01261991852,3176.73029873432,3176.81081160733,3176.89125088920,3176.97159099028,3103.35071787897,3177.19992855958,3177.53296014402,3177.57286843389,3177.61186195276,3177.64987400676,3177.68685960603,3177.84351808177,3177.87591277628,3177.90703132975,3177.93678588153,3177.96511418907,3178.00880548171,3178.11053214636,3178.13557861207,3178.15880791211,3178.18009908706,3178.19933274425,3178.31441897347,3178.33149257099,3178.34611304365,3178.03566848811,3178.06022306848,3178.10208340711,3178.20999935585,3178.22664997580,3178.23981427699,3178.24926802496,3107.42769209725,3107.30895788279,3107.58740890852,3107.49124056805,3107.36589501426,3107.38239957511,3107.19639183868,3107.24643995265,3106.99297628121,3106.69867788399,3106.36082595296,3106.18664582468,3105.69952977563,3105.62056920181,3105.08922187446,2885.53214702019,2882.79355768169,2880.54430055612,2876.58327410121,2888.78757774581,2900.92368710084,2873.29902428979,2864.89751368050,2854.08450431745,2816.57154329748,2818.10091748421,2397.51022434172,2103.58020537138,2189.58039924067,2268.51337182805,2224.48692646040,2252.29291832645,2226.52519992932,2256.39631295502,2257.29922577350,2258.88176763644,2262.84973806452,2273.21890904205,2285.76021042489,2297.53082177130,2301.23801262247,2282.91354867887,2293.12207841214,2300.00653715677,2300.00212138761,3164.51803532094,2306.44888118002,2302.85727511077,2314.19950697003,2318.00396780218,2321.42205671215,2324.82957714798,3193.90824478942,2332.12185975522,2335.44011684105,2338.85043438116,2342.12623823766,2346.01492465903,2349.40827434110,2353.94094999945,2362.15967225033,3156.16297230174,3160.60496384564,3164.69684310588,2469.60240333145,2463.29218538633,2375.48109186707,2445.46136475887,2448.76357655885,2479.36352219140,2498.80834906935,2497.59543448634,2477.62490542044,3123.77821243343,3127.39009655543,3130.80288722413,3133.62581283286,3136.17733618998,3138.50149595415,3140.80360914485,3142.81773094546,3186.07737743280,3187.25751674746,3187.46334658944,3187.66065832069,3187.85027177395,3188.08768981802,3188.26372552156,3188.43406635790,3188.59921727127,3188.75963969588,3188.97598293842,3189.16252373505,3189.31343704271,3189.46105181240,3189.60563198097,3189.74742232530,3190.49445724116,3190.68742200362,3190.87807482957,3191.06662671549,3191.25326864136,3169.07708999255,3190.49013184378,3190.55764319578,3190.62382783037,3190.68874927991,3190.75246149916,3191.19338156361,3191.55697678240,3191.66948953250,3191.39232931477,3191.09330873773,3190.79122220501,3191.06910683350,3190.71684983150,3190.36246916016,3190.00654779454,3189.64964092538,3188.71092630687,3187.91655540696,3187.67128444818,3187.42909101946,3187.19034409873,3144.95739176541,3187.03075913788,3187.06963157492,3186.79199176715,3186.51808923064,3186.24810780706,3185.98220159249,3185.82735628938,3185.56615719423,3185.30927717593,3185.05678044353,3184.80871137264,3184.58430597316,3184.37262773347,3184.13840471402,3183.90863598309,3183.80341035595,3183.90737648953,3184.05452256917,3184.15914076218,3184.26366547977,3184.36810980281,3184.47249152755,3184.57681696033,3184.73534488317,3184.83891661290,3184.94246987017,3185.04601009389,3185.14955196094,3185.27622107267,3185.41011347267,3185.51386279403,3185.61763416577,3185.72143095779,3185.82537190310,3185.98476983671,3186.08927597518,3186.19382057786,3186.29840294452,3186.40302710683,3186.50769289074,3186.67633469844,3186.78324676016,3186.89020755553,3186.99722001235,3187.11399519443,3187.24830827553,3187.38472994557,3187.50303513785,3187.62142515092,3187.73989702719,3187.85844519998,3188.02477384012,3188.14321760777,3188.26172693582,3188.38030457371,3188.49894667289,3188.64102828585,3188.78517398398,3188.90390550194,3189.02268788800,3189.14151552012,3189.26038569709,3189.39837939778,3189.53783396192,3189.65710086798,3189.77640040939,3189.89572926927,3190.01508554583,3190.18383330362,3190.30379699406,3190.42378051889,3190.54378089800,3190.66380054195,3191.13776442098,3191.23434673939,3191.31021849371,3191.38610151345,3191.46199787748,3191.53790583224,3191.68176313728,3191.75984419606,3191.83794294076,3191.91606223548,3191.99420182360,3192.07236050435,3192.19333651190,3192.27074684614,3192.34817665024,3192.42562366200,3192.50308438856,3192.60263823318,3192.70384944032,3192.78234264238,3192.86085570910,3192.93939088007,3193.01794729792,3193.14259774797,3193.22241550507,3193.30225594706,3193.38212640074,3193.46202262341,3193.54194400578,3194.74765345069,3194.87384786237,3195.00007605724,3195.12632716361,3195.25259479382,3195.40995557718,3195.56686971232,3195.69194302722,3195.81700419520,3195.94205665560,3196.06708341001,3196.24215488979,3196.36710957662,3196.49202816611,3196.61690241053,3196.74173029530,3196.86650959825,3197.03226295242,3197.15701241825,3197.28169385556,3197.40630374261,3197.53084170745,3197.70858207528,3197.83270216965,3197.95673778290,3198.08069469087,3198.20456345198,3198.32834877175,3198.71932961984,3199.46096603534,3200.19268273028,3199.26555726946,3200.10790266642,3200.18944910925,3199.51295524712,3200.16733561467,3200.30375460548,3199.58349260791,3199.64408309246,3199.64611770445,3199.72196955484,3200.40901510540,3200.50649305202,3200.60187365443,3200.69519224701,3199.73166414199,3199.76086185229,3199.79009967768,3199.81937924857,3199.84870020142,3199.87806097375,3199.02022135447,3199.06052788503,3199.10100128191,3199.14163861534,3199.18243627656,3207.36156222589,3217.89088643850,3218.38840471194,3218.88412351409,3239.84905165426,3167.03231036252,3175.92959781675,3177.47934268964,3184.92145359551,3189.38481137799,3254.60942331290,3202.96409940208,3202.71946192300,3208.42646509201,3214.69792058555,3220.61082566052,3223.02527031456,3232.43121999156,3256.05222467470,3208.39624282722,3206.13914128011,3203.87919043929,3201.61767545336,3200.79912170196,3199.66710131689,3199.41182088702,3199.15719246563,3198.90334934137,3198.70162267345,3199.77561232059,3199.66163275982,3199.54830103116,3199.43567619857,3199.32381456430,3199.36439892100,3199.52376927436,3199.64787808769,3199.21297538906,3201.40335706824,3201.44442757010,3201.54277849206,3201.58471195324,3199.32400042055,3198.82708032630,3199.11135623829,3199.39792153300,3199.68400762191,3199.96228977894,3200.24066934952,3200.51914866996,3200.79772680824,3201.19051595561,3201.46841456908,3201.74640535048,3202.02448767554,3202.30267089133,3202.58093855196,3202.95371088702,3203.23037210060,3203.50712242275,3203.78395308063,3204.06087576603,3204.32471255307,3204.57127517448,3204.84738092368,3205.12357327382,3205.39985108676,3205.67621587668,3206.01144617934,3206.28593048142,3206.56051037823,3206.83521374103,3207.11007725886,3207.54456416356,3208.19034214543,3208.49585766335,3208.74550793315,3208.87591040428,3209.00674728164,3214.74787039434,3216.40798525789,3220.15269380812,3224.92726424126,3229.70040888509,3234.47145745602,3239.24003050770,3244.05925178510,3248.83026899447,3253.60036333292,3258.36953572796,3263.13782467493,3267.92459369062,3272.69690872256,3277.58876876748,3282.51683339591,3287.44442891899,3292.37155470484,3297.29820493264,3302.22433903286,3307.15005852875,3312.07530602355,3317.00008153349,3321.92436633524,3326.84819588331,3331.76907593512,3336.69191180844,3341.61430765402,3346.53626369354,3351.45776936662,3356.37884449586,3361.29948002974,3366.22103352236,3371.14075144158,3376.06003036203,3380.97890008539,3385.89731212328,3390.81528743957,3395.73282614777,3521.59913144142,3526.65710609719,3531.82071829212,3536.87657767093,3541.92716352702,3546.98137913784,3552.03486387687,3557.08809459593,3562.14013864445,3567.19146503439,3572.24206999733,3577.38710489799,3582.51739858317,3587.64744715107,3592.77713099068,3597.90651895866,3603.03561683236,3608.16630032311,3613.29409441426,3618.42243584494,3623.55049320991,3628.67825969073,3633.80575474795,3639.56528969559,3644.70593068396,3649.80264387158,3654.90074578924,3660.00047674293,3665.10162548274,3670.20420414129,3675.31629916647,4087.73526723787,3991.09940220029,3995.27389595747,3997.80011887826,4103.15722899339,4011.76527686899,4795.87282020908,4109.57849474157,4029.31046360630,4067.46948155135,4101.72637391537,4128.37682502855,4051.65643176115,4091.93998463681,4063.91476892057,4067.48517383030,4071.16199972267,4080.37458694305,4083.77716284211,4091.39194623103,4098.77902858893,4104.06942755563,4108.15227496516,4113.42574579341,4117.20317347621,4122.95388984877,4131.50561601188,4137.43379742898,4143.39361781630,4149.41697675752,4154.75821809720,4160.45532583071,4165.61212205876,4171.85289116192,4177.81751911269,4182.60713357159,4188.65641160689,4194.73540836795,4200.55263600854,4206.24083669357,4211.90523348785,4217.60515759041,4223.29084569786,4228.97427281121,4234.66015955388,4240.34052205376,4246.02716562006,4251.71112909437,4257.39425366767,4263.07837618485,4268.76249092584,4274.44733346975,4280.13047774082,4285.81301539436,4291.49686401891,4297.18400615820,4302.86838659053,4308.55212330109,4314.23559436226,4319.92076453885,4325.59622825791,4331.28953498331,4336.97077442237,4342.65619649324,4348.34006582971,4354.02208295569,4359.68492288768,4365.37257590880,4371.07464207505,4376.75509975584,4382.44562187246,4388.10112673432,4393.81408185097,4399.49737482024,4405.18095535103,4410.86499694931,4416.54872329756,4422.23496806306,4427.91855087191,4433.60001511311,4439.28530789195,4444.96901455251,4450.65411207025,4456.33222771456,4462.02395968305,4467.70697969542,4473.38961577149,4479.07634672356,4484.75927280416,4490.44117246362,4496.12811124027,4501.81022429041,4507.49685873385,4513.18049795504,4518.83953868336,4524.54544386334,4530.20999027694,4535.91408221342,4541.59945530818,4547.28392595921;7.60406225819600,8.04459556079033,9.36677801066548,10.4524859809162,11.4914791836119,12.5951045192071,13.6361471571242,14.7795777854803,15.8558100152971,16.9780448767072,18.0788850627540,19.1854926878200,20.3022642506133,21.4011945501068,22.5298916376443,23.6366297046035,24.7627082963196,25.8690486740598,27.0271518396072,28.1175404562232,10.2613840321397,10.5649825503860,10.8922498234229,11.2314759032208,11.5627879200256,11.8864600217505,12.2027537838552,12.5119189423831,12.8525451700717,13.1869306920858,13.5158983171513,13.8395790468479,14.1580996729024,14.4815497457823,14.8149864277229,15.1443208683300,15.4696286861395,15.7909836244065,16.1084576198055,16.4389439133732,16.7705435487981,17.0990426359004,17.4244848009668,17.7469128342154,18.0699874967882,18.4016403742277,18.7316601042718,19.0592391983780,19.3844049241037,19.7071841396725,20.0322051427541,20.3635289335652,20.6928697842436,21.0202456060135,21.3456740952695,21.6691727172643,22.0003531177204,22.3307567606189,22.6595290966459,22.9866823185181,23.3122285086316,23.6386923448423,23.9698883899217,24.2997111180097,24.6281691908432,24.9552712056265,25.2810256799575,25.6103295461934,25.9409778027942,26.2704626614979,26.5987903667565,26.9259671323284,27.2530291173364,27.5834576979229,27.9137658949122,28.2430769278856,28.5713954308174,28.8987259991237,29.2272015126137,29.5581727868252,29.8880796940864,30.2170464231945,30.5451489282532,30.8723907415687,31.2024333317231,31.5329823260696,31.8627714766371,32.1918035274469,32.5200811915708,32.8491135217673,33.1798767427204,33.5110175136042,33.8414995712371,34.1713249214928,34.5004955453489,34.8299081202708,35.1600540945973,35.4895948153129,35.8185320930196,36.1468677421839,36.4746035861689,36.8050826718646,37.1359382086949,37.4662646251173,37.7960633030496,38.1253355979039,38.4544357100060,38.7858370476498,39.1167646225768,39.4472195568051,39.7772029458846,40.0982864171059,40.4285157217467,40.7600078677808,41.0910766838224,41.4217230671904,41.7519479044872,42.0819672879702,42.4129658210360,42.7445058638623,43.0756639784875,43.4064408790552,43.7368373227341,44.0669460056734,44.3989204945955,44.7305486328526,45.0618310492937,45.3927683360080,45.7233611168829,46.0543692320699,46.3864310379294,46.7181784489749,47.0496119847041,47.3807321645411,47.7118319476045,48.0433441604125,48.3755138870859,48.7073972995627,49.0389948210930,49.3703069029089,49.7012836293841,50.0346968823827,50.3682307170645,50.7015168167961,51.0345554892670,51.3671220552683,51.7003808143756,52.0343813796193,52.3681560393342,52.7017050395010,53.0350286116716,53.3685072971111,53.7019750037354,54.0362525566852,54.3703241879088,54.7041900920575,55.0378504711851,55.3711908286736,55.7058588241989,56.0403379695377,56.3746284019815,56.7087302690413,57.0426024007965,57.3767407757816,57.7118974460281,58.0468842980359,58.3817014806869,58.7163490723414,59.0491074314806,59.3874296596595,59.7256309117418,60.0849162503712,60.4218332230593,60.7586232589979,61.0952449535857,61.4271454314789,61.7588493361098,62.0903565852333,62.4216671592406,62.7533980369038,63.0848345224645,63.4196698542301,63.7543637918507,64.0889165247693,64.4233282295841,64.7570753978301,65.0922270068902,65.4272473539088,65.7621366130514,66.0968949783932,66.4313581749639,66.7657845337728,67.1012686837905,67.4366339316341,67.7718804282739,68.1070083728771,68.4421940211478,68.7769465096271,69.1126696064552,69.4482837695316,69.7837892630274,70.1191862717489,70.4208610581128,70.7620132144333,71.1030047417989,71.4438251933706,71.7844637747432,72.1248156817699,72.4646953027257,72.8055782248631,73.1462420185429,73.4866753278056,73.8268667633742,74.1656922954194,74.5062751956919,74.8465910044428,75.1866297651374,75.5263807252842,75.8658346665282,76.2029902461224,76.5438059368725,76.8843158327619,77.2245123369413,77.5643889997252,77.9018750645646,78.2446238178421,78.5817144635072,78.9184533980796,79.2548403407839,81.4108348826047,79.9219625355277,80.2614212606911,80.6532769550336,80.9924587865669,81.3316176479333,81.6696531625462,82.0141285276897,82.3490500153442,82.6838791798545,83.0186167150775,85.3958883024800,83.6895586463111,84.0191306747110,84.3565362535023,84.6938997688240,85.0312233800261,85.3685086485348,85.7039225893241,86.0419297254256,86.3799128571736,86.7178748393172,87.0558178647986,87.3940418472266,87.7303448753565,88.0687585627973,88.4071703452026,88.7455842567756,89.0840043424059,89.4205917851617,89.7595218375178,90.0984753473710,90.4468481939724,90.7854518772435,91.1241747541984,91.4607733677684,91.8000200165934,92.1393267695298,92.4787014077179,95.0136505113406,95.3659486166976,95.7054797379165,96.0569911652531,96.4094346739649,96.7577011471877,97.1126897062571,97.4599560502970,97.8171634075873,98.1757498905510,98.5361045499374,98.8918353627182,99.2580266517477,99.6105931220260,99.9784544529083,108.367123289217,108.855303329243,109.325056844783,109.864182074710,109.755946656641,109.651189943209,111.140868266256,111.867143424840,112.697162972391,114.667129336392,114.991990278146,137.159853320042,158.841130649283,152.488691495040,147.157528595122,150.867809947782,149.327373948060,151.749924038032,150.044210676617,150.487443327625,150.881391230763,151.097934318536,150.844189824136,150.435052874783,150.086621764369,150.318293933093,152.148253569202,151.902498953383,151.899857540793,152.396732626872,108.662584770679,152.919133482703,153.677177352016,153.343025495358,153.558863687609,153.801912587991,154.044885954399,110.004201463522,154.493571388973,154.740520762730,154.979998730791,155.228445172157,155.431403340215,155.669871980347,155.824434285388,155.710173621775,114.491792014595,114.668832690391,114.858630367373,150.177357662612,151.054777740972,157.627980835083,153.174006993139,153.411850927551,151.811825011470,150.983236752198,151.512316677204,153.293547937225,119.940397446929,120.144727743423,120.357196278914,120.592981990925,120.839283210263,121.094360197215,121.349942847302,121.616979938863,120.225029933685,120.521867816948,120.857092928019,121.192610655770,121.528391157663,121.862646618433,122.199142101599,122.535828747467,122.872688070280,123.209703160521,123.544851503750,123.881188301456,124.218949126030,124.556814789808,124.894775566817,125.232822405739,125.549467138531,125.888469802837,126.227533677680,126.566650789167,126.905813901601,128.184400415693,127.623501783206,127.961868143459,128.300269694455,128.638704104605,128.977169420080,129.302525411739,129.631493534324,129.971195699918,130.327650416850,130.685118599565,131.042794554395,131.379113632604,131.742144715581,132.105352009724,132.468710260106,132.832195218012,133.216552954202,133.594350299510,133.948194512218,134.301974139318,134.655671672332,136.922044090299,135.353430550105,135.697508572322,136.055888553616,136.414177440824,136.772365634880,137.130444800203,137.484507485313,137.842983674784,138.201337263106,138.559563793242,138.917659729825,139.275055262769,139.631811032157,139.989681888138,140.347415706738,140.699420303949,141.041701798180,141.382343893731,141.724766562778,142.067185527707,142.409600212551,142.752009804982,143.094414025330,143.434791999227,143.777443077096,144.120088359095,144.462727597469,144.805360099995,145.147272490602,145.488649083070,145.831479379253,146.174302972372,146.517119700863,146.859923748388,147.200495098302,147.543498126763,147.886494548196,148.229484333610,148.572467314230,148.915443438000,149.255879855080,149.599011605155,149.942136657524,150.285254864889,150.627879581577,150.969852905189,151.311608743975,151.654273237601,151.996927166024,152.339570656143,152.682203953747,153.022783237362,153.365606159770,153.708420347564,154.051225677538,154.394022295382,154.735859175708,155.077522631082,155.420499413796,155.763469068597,156.106431825474,156.449387847992,156.791589927853,157.133616320015,157.476700086599,157.819778180044,158.162850773626,158.505917953851,158.846725111427,159.189953287201,159.533177115482,159.876396747935,160.219612041914,160.543993235354,160.888580615780,161.234292388993,161.580011539982,161.925737919055,162.271471639592,162.613880276853,162.959785316664,163.305697841975,163.651617701721,163.997544893342,164.343479479139,164.687339221321,165.033497812758,165.379664759319,165.725840150742,166.072024186868,166.417157606794,166.762205647640,167.108536332626,167.454875726117,167.801223695599,168.147580276925,168.491565365934,168.838047697824,169.184538885470,169.531038510299,169.877546792209,170.224063765628,170.506276506923,170.850188225781,171.194097548532,171.538005075956,171.881911174867,172.224176061558,172.566528073698,172.910731747126,173.254937075124,173.599143865869,173.943353106730,174.284796485224,174.629193654719,174.973594692510,175.318000089904,175.662409980517,176.006824505167,176.348982316423,176.693549784818,177.038123676680,177.382704225726,177.727291474909,178.068766708155,178.413573240455,178.758388196021,179.103211260572,179.448043024418,179.792883232033,180.121525108971,180.428732651899,180.736401040250,181.145583854126,181.446397712060,181.793833564387,182.188431982365,182.501072450724,182.845672080381,183.243439409972,183.592860665123,183.945857806351,184.293978707236,184.603912544723,184.950628584926,185.297485369612,185.644481482004,186.052433169590,186.405487941879,186.758579339308,187.111707299570,187.464871838500,187.818073019253,188.235117716621,188.591511264148,188.947940158713,189.304404527824,189.660904551623,189.486289128660,189.159868138273,189.484494900955,189.809177685823,188.808866298962,191.291477170420,191.316930393738,191.237093687562,191.245986136470,191.207619042339,189.955847999585,191.203944167759,191.387056102462,191.364594127491,191.292984424739,191.257924001215,191.496120667700,191.178145266201,191.230698458653,193.893077655820,194.410560619668,194.928949390538,195.448156945935,195.861106951151,196.289418442460,196.658942003933,197.028525663664,197.398160188118,197.764363629256,198.044409888865,198.404974960881,198.765566016510,199.126178796781,199.486809205858,199.837547031263,200.180507752026,200.525842785283,200.909829721022,201.112105349256,201.463059686998,201.810261070896,202.161531385392,202.673666278508,203.062884199908,203.397651020926,203.732228830362,204.066835294781,204.401955922655,204.737044285247,205.072100162276,205.407123555558,205.734105151662,206.069323361899,206.404510548596,206.739666698125,207.074791080815,207.409884813853,207.738252158396,208.073577106134,208.408872353727,208.744138479186,209.079374581356,209.415533969250,209.752889798331,210.088044144510,210.423168850350,210.758263943169,211.093329262418,211.424015761323,211.759275317299,212.094505636410,212.429704617681,212.764869476629,213.088257333026,213.395410290252,213.729006025136,214.066933252017,214.414179405148,214.761430285963,214.689548948168,214.922880481511,214.999886554556,214.999956011403,214.999971531445,214.999978150944,214.999981406871,214.999984312026,214.999985689404,214.999986655727,214.999987361993,214.999987887030,214.999974953701,214.999977366545,214.999983846383,214.999984760972,214.999985507401,214.999986126365,214.999986545052,214.999990463180,214.999990379452,214.999990315039,214.999990265663,214.999990218789,214.999990187132,214.999990102440,214.999990083299,214.999990069773,214.999990060528,214.999990041155,214.999990037713,214.999990037106,214.999896626093,214.999899404926,214.999902143293,214.999906539389,214.999908975999,214.999911294956,214.999913505590,206.999971013560,206.999913170579,206.998556693044,206.998543409999,206.998821979438,206.998826051300,206.998830838391,206.998809704829,206.998820911524,206.998834204326,206.998849797439,206.998878579952,206.998897050293,206.998913239637,206.998934505884,206.998956628703,206.998979266163,206.998887298238,206.998954644780,206.998971944469,206.998989453367,206.999007616002,206.999025246016,206.960490850158,206.959717902682,206.961601125482,206.963378819189,206.965036777264,206.966588222916,206.968032788585,206.968881900281,187.178146047208,189.855386124921,189.888594632761,190.066168793344,187.579576682923,189.904977792873,160.428182276143,188.116121498665,189.880878653649,190.045711980091,189.254113354754,188.355904613943,189.924722181396,190.082390322668,189.888289037197,190.012896646678,190.118624181591,189.934659061361,190.066558333011,189.964634800661,189.908771908198,189.911749200166,189.997572754086,190.025682989280,190.137070965480,190.136817664373,189.984684018857,189.976585492629,189.966787527460,189.953542816365,189.977893247777,189.982622219058,190.016225689796,190.001101991286,190.001813402424,190.064630892097,190.060825589699,190.055595208963,190.063525080857,190.079184513365,190.094913361521,190.110730762003,190.126140484992,190.141627080260,190.157395385729,190.173071800656,190.188641442403,190.204244221089,190.219866095348,190.235492878990,190.251070115573,190.266478845767,190.282283411126,190.297848001154,190.313475253068,190.329098342543,190.344702855347,190.360342937444,190.376000062101,190.384567876879,190.391277496787,190.397881346854,190.404627561699,190.411120189056,190.417974250589,190.424513038763,190.431291362743,190.437782979481,190.444577954279,190.451328629216,190.458023714933,190.464527565457,190.471336882403,190.478053243025,190.484730024191,190.491408072847,190.498085962600,190.504706117818,190.511413528610,190.517968522008,190.524846730363,190.531485465931,190.538055838239,190.544802264535,190.551460756999,190.559231768674,190.567090973573,190.575756863044,190.583958919016,190.592702866283,190.600893564225,190.609248558132,190.617579293775,190.626145381942,190.634505936998,190.642814123740,190.651260979443,190.659524258186,190.667955161553,190.676452084499;9700.11426186813,9700.11425113899,9700.11422215720,9794.96746710773,10012.7176285746,10244.0574852122,10462.0531377944,10701.8374258852,10927.3973707846,11162.5870448844,11393.3027133374,11625.2188407969,11870.0836690838,12139.6483651131,12416.4948697198,12687.9377426499,12963.8945571223,13244.0777323204,13519.2990089694,13789.9875394001,35389.6170846282,35583.8888042266,35800.9995013132,36018.5106022137,36230.9029642036,36438.3552715478,36641.0379989115,36839.1138140036,37064.1049443694,37278.6661779967,37489.7191239845,37697.3493028485,37901.6394339845,38114.1987770414,38328.2665416779,38539.6756051495,38748.4753594436,38954.7139635488,39158.4384098919,39375.7691592620,39588.7538210732,39799.7274600458,40008.7185780472,40215.7551485260,40425.2843772662,40640.7111249467,40852.7557787220,41063.2165710423,41272.1113186469,41479.4575710382,41700.7066698553,41938.0727550492,42173.9985300955,42408.4969399691,42641.5807558417,42873.2626093185,43114.5440445110,43351.2955323031,43586.8609788566,43821.2491671463,44054.4688048880,44292.1400900510,44529.5145731248,44765.8897196642,45001.2717632004,45235.6668608082,45469.0811218682,45708.7139335424,45945.7308446236,46181.9003960198,46417.2270374633,46651.7152216614,46887.8365176152,47126.4819184146,47363.2910086552,47599.3732520767,47834.7319486190,48069.3703406360,48308.1887769756,48545.5135444775,48782.4340529782,49019.4197186279,49256.0900514084,49492.1326349899,49733.5259720776,49972.0494916810,50210.0194271835,50447.4377269334,50684.3063341000,50923.5401186966,51164.2688291662,51403.4867886474,51642.2299177067,51880.4996320496,52118.2973498827,52357.8159599162,52595.8726452591,52833.4822682902,53070.6461044962,53307.3654174305,53543.6414433212,53785.7344913477,54024.5838550949,54263.0473583880,54501.1259457983,54738.8205731368,54979.2497789386,55218.5562556702,55457.5177823911,55696.1350994520,55934.4089656854,56184.2527207830,56443.5925310217,56701.1289707456,56958.3330274297,57215.2053578637,57471.7465999009,57729.5268569006,57988.0486184401,58245.6656199082,58502.9829136350,58760.0010488307,59016.7205377272,59275.9089427681,59533.9070970204,59791.6336781064,60049.0891176766,60306.2738572569,60563.1883198752,60823.0852673222,61081.1880674311,61339.0444319010,61596.6547228564,61854.0192930996,62112.6882699948,62371.6588481876,62629.8858728807,62887.8886343579,63145.6674355463,63403.2225606259,63663.0772983708,63921.0795858125,64177.4687833255,64433.6473683827,64689.6155481453,64946.4768908167,65203.8703382134,65460.5717027162,65717.0798149519,65973.3948547878,66229.5170033193,66487.0811989113,66744.6690737095,67001.5556903485,67258.2659377914,67514.7999846008,67771.1579787106,68029.7283156791,68286.8556322380,68543.8198656783,68800.6211616214,69057.2596660430,69315.1552857231,69573.2933535532,69830.6730358129,70087.9032549912,70344.9841050703,70601.9157325068,70864.2572204778,71122.9971346786,71381.5992822358,71624.3552244584,71864.6280605908,72104.7844989066,72338.5873543530,72577.5155338283,72816.3200084526,73055.0008418120,73293.5580690021,73535.8175724907,73777.7989130688,74017.7633759983,74257.6229186926,74497.3775720289,74737.0273811544,74978.7061989047,75218.9939388989,75459.1852951733,75699.2802989611,75939.2789582484,76180.2918519093,76421.4516011152,76661.9287846602,76902.3169589287,77142.6161275939,77382.8262970822,77624.2063788878,77865.4645906363,78106.1122268519,78346.6773913169,78587.1600499940,78835.2925799849,79113.4928270111,79374.3276164863,79635.0111858445,79895.5512704607,80155.9561091326,80417.2608845758,80678.6744872674,80939.4226314615,81200.0778849572,81460.6503750376,81721.1505790319,81983.9141860125,82245.1411473783,82506.3366730852,82767.5115140248,83028.6771078032,83289.8442576180,83558.5796006896,83822.4262032696,84086.3403276921,84350.3315876426,84614.4090104709,84874.4748636279,85131.7267805060,85392.2145652683,85652.7635689089,85913.3809904866,85078.4492088224,86447.8552730119,86716.8349122059,86954.6988140986,87225.2294237096,87495.6916628506,87762.3622804577,88026.7638240226,88296.8896303485,88566.9459776320,88836.9324619360,87991.8112507204,89380.6008822587,89655.8553473386,89926.5113676617,90197.1032945775,90467.6302512632,90738.0916805647,91011.5244377465,91282.4019972734,91553.2155264376,91823.9638503580,92094.6462104125,92366.1311931631,92638.2657875782,92909.2115215799,93180.0895372954,93450.8982612258,93721.6361665672,93994.5322527688,94265.6028876180,94536.8737807965,94804.0568742895,95076.0902984708,95348.8737828062,95622.4551601136,95894.7043934710,96166.8698720248,96438.9493436346,95789.5909751708,96067.1686983278,96349.5488549603,96627.3503230104,96904.7943760388,97184.2598492322,97461.4469322236,97741.3805037584,98017.7924132848,98293.7638656215,98569.5035113350,98847.7322876797,99122.4988244790,99401.7959379880,99676.2264591566,98316.1283263281,98595.4927807660,98874.6143098007,99153.4253611657,99432.3643470471,99718.5559423029,100037.375032719,100334.790108358,100620.120156039,100816.470619508,101101.221701840,98622.2420073210,97816.9940959183,98338.3272492899,98704.6099329465,98936.8653041300,99243.2324042674,99572.0178387654,99836.9325284761,100150.185050881,100462.997878146,100771.601744105,101072.730887372,101374.297822990,101679.598603699,101986.903063344,102303.465956638,102602.186608793,102904.062559362,103209.440302826,108877.236820380,103818.799519626,104124.182681848,104424.972793658,104726.927481490,105028.077270695,105328.470369554,111063.155686435,105927.011819814,106225.148501608,106522.581929745,106819.274169691,107115.219936636,107410.582339683,107705.183668852,107999.759870411,113228.275794685,113538.058254206,113844.810646489,109239.213717343,109531.108061127,109748.219143592,110103.077645656,110393.176403370,110687.850926426,110972.603054816,111264.352108201,111559.432312366,116365.434962908,116665.003774896,116963.246269248,117257.735903432,117550.330327351,117841.310601213,118131.861232369,118420.635954865,118949.200413809,119230.164190144,119504.828366672,119779.403452272,120053.896693028,120328.984722217,120603.533891775,120878.019971500,121152.447340727,121426.819988451,121701.822585211,121976.643893352,122251.250994666,122525.816912629,122800.343886189,123074.833966942,123355.188705244,123632.376902173,123909.526555850,124186.639298984,124463.716594946,124642.358524746,125006.201207665,125278.135702272,125550.048077443,125821.938879215,126093.808592021,126369.518056686,126645.177111197,126919.879106801,127188.863745639,127457.215995927,127725.381760482,127999.424049146,128269.552026052,128539.457962570,128809.143046351,129078.609061577,129340.062342542,129601.649904905,129867.058481816,130132.361074468,130397.563420708,130249.495427657,130933.787385106,131203.290448358,131469.916873939,131736.425953813,132002.822914109,132269.112900870,132537.174123142,132803.625163397,133069.981428839,133336.247567824,133602.428103352,133869.005910024,134135.528720415,134401.658658566,134672.203995316,134944.414781934,135219.134098924,135494.664237825,135769.531856044,136044.394452799,136319.252207615,136594.105343951,136868.953946282,137144.848417254,137419.860298937,137694.869136290,137969.874998488,138244.878055117,138520.443893679,138795.942840349,139071.119742294,139346.294866519,139621.468250906,139896.641110116,140172.765304723,140448.128056283,140723.489927793,140998.850863475,141274.210928663,141549.570075226,141826.059108769,142101.656394738,142377.253291454,142652.976409809,142928.814017355,143204.996157198,143481.110001113,143757.053828482,144032.993476375,144308.928900128,144584.860021158,144861.509551133,145137.585063383,145413.656897021,145689.725089434,145965.789567183,146242.244231755,146518.663159581,146794.874053730,147071.081817125,147347.286356012,147623.487667183,147900.030241840,148176.505781586,148452.827216759,148729.145776031,149005.461433722,149281.774164985,149558.721711872,149835.191090790,150111.658012618,150388.122451118,150665.861190975,150946.710610249,151225.142493921,151503.459349066,151781.789260636,152060.132213642,152338.488213804,152617.556738136,152896.172200466,153174.801321757,153453.444126012,153732.100601430,154010.770740976,154289.919840789,154568.746391615,154847.587332093,155126.442623997,155405.312255017,155684.452929158,155963.616984013,156242.676932056,156521.751674209,156800.841219854,157079.945557805,157359.477428660,157638.760585055,157918.058917903,158197.372465208,158476.701193004,158760.279256091,159050.370617113,159336.467253534,159622.563636499,159908.659709036,160194.755448914,160481.076796496,160767.446599136,161053.724460084,161340.003057277,161626.282407305,161912.562460149,162199.104503428,162485.533813539,162771.964458530,163058.396424084,163344.829717770,163631.264342603,163917.919843412,164204.477386008,164491.036739294,164777.597916622,165064.160934264,165350.862852445,165637.583276134,165924.306311473,166211.031992713,166497.760326148,166784.491340100,167071.737910114,167359.004372909,167648.613868291,167933.435439097,168220.592134083,168508.592302288,168794.585850231,169082.454633111,169371.761717664,169656.859450158,169944.014810159,170231.482343790,170518.110697868,170808.973376762,171097.437304271,171385.877584806,171674.295393108,171949.826577235,172238.325645528,172526.818841658,172815.306093357,173103.787314558,173392.262415343,173701.297918241,173993.242339154,174285.169408103,174577.078801420,174868.970223520,175238.568192747,175666.533085814,175963.376104898,176260.146176799,176827.246686704,176051.553962094,176365.363404118,176294.192516714,176538.444074006,176620.108932493,178732.454929093,177164.745721346,177419.707805170,177816.641897187,178176.828723554,178563.139646823,179132.628256966,179310.229784687,181158.970285820,181686.515055014,182260.595811829,182819.384442954,183362.811444936,183888.077246400,184424.528555000,184962.106825983,185499.958875875,186038.073899286,186572.614017524,187012.150393780,187540.379412866,188068.735814097,188597.214123878,189125.808965714,189643.463686323,190229.978332257,190890.009488365,191610.609715731,192204.544495438,192877.968591703,193552.036448333,194226.179117282,194969.647671786,195698.761773448,196342.402171513,196985.736063609,197629.113354765,198273.287820096,198944.524706817,199619.962981072,200295.352872001,200970.962974947,201646.631230263,202322.252977095,202997.828104657,203673.356494861,204348.838038363,205024.364503493,205700.067689453,206375.726469438,207051.340750986,207726.910408372,208402.458421092,209077.935329176,209753.238375168,210428.496788162,211103.710465451,211778.879307321,212453.716369488,213128.999240528,213804.239468759,214479.436844346,215154.591055268,215829.029946026,216501.292955031,217177.627353565,217854.611255664,218533.120649921,219211.698083754,219855.228087447,220524.879463566,221180.385619039,221829.462254192,222478.242462565,223126.720842239,223774.856356548,224429.875149491,225078.339291206,225726.677217026,226374.889340351,227022.981043351,227673.558888312,228322.201396373,228987.099822492,229656.908470440,230326.653039078,230996.333519968,231665.948983401,232347.490181297,233043.527898796,233739.498955429,234435.403345575,235131.238399593,235827.009152050,236522.363017424,237217.993380197,237913.561574772,238609.067629958,239304.510025352,239999.891613032,240695.211088427,241390.475855846,242085.670672834,242780.803405484,243475.881644123,244170.891345123,244865.839124844,245560.725016167,241981.902190193,242284.588191763,242590.660201468,242893.343668187,243196.363488834,243498.983291574,243801.560782484,244104.066249901,244406.571521826,244709.037971047,245011.465732628,245319.574799968,245626.778622934,245933.962413537,246241.134392860,246548.289748292,246826.387182507,247084.301060310,247342.396863263,247600.417403320,247858.424100957,248116.417527610,248374.396223020,248584.849928433,248841.843313216,249102.093993591,249362.199149196,249622.141450084,249881.937329004,250141.586477861,250400.488539307,230675.319170419,228214.611174778,228577.863310085,229086.283426232,232297.777933053,229718.633174444,245554.063434874,233503.710026058,230817.692810751,233547.503172706,234605.413929654,235114.268260153,232329.601395915,235184.461018815,233068.902859038,233488.194266969,233917.587157028,234202.061205573,234633.305572951,234958.155284872,235355.269912555,235702.175598886,236089.001849467,236475.429632838,236902.292794220,237273.181396532,237580.389445640,237952.511597220,238324.532522927,238696.207707650,239074.516262016,239449.199903787,239831.922205433,240210.682779860,240597.274162302,241008.221562161,241392.842909987,241777.108270825,242174.030382289,242652.765619799,243129.370776690,243608.603307315,244085.717882590,244562.434659338,245039.442714512,245515.525708360,245991.603405718,246467.177373583,246942.372057977,247417.311737578,247891.835945726,248365.830469718,248839.928631187,249313.286881113,249786.498505864,250259.623517112,250738.751498004,251223.973126684,251708.812398276,252183.676033847,252655.011406488,253127.492205207,253599.018350220,254070.383630539,254541.936803011,255012.761431017,255482.173716334,255953.072656999,256425.366698011,256895.681203381,257366.579194706,257834.232474163,258306.765165079,258776.608408195,259164.478106213,259544.772637767,259925.396486333,260306.460346602,260687.812835529,261069.171630068,261451.571412566,261833.890935205,262216.551941907,262599.355611193,262983.277269627,263368.657169215,263754.554827747,264142.395826266,264529.703104474,264918.248641818,265306.676153037,265753.693919319,266325.833183412,266898.185475636,267467.892138461,268042.225131976,268612.843997795,269187.148313060,269760.012463200,270333.015236074;0.125580047572998,0.237406217407397,0.305842148754984,0.365431092959150,0.415488466809717,0.454895907644747,0.490204827920789,0.516884887089009,0.542025694645097,0.562442551341822,0.581013761662316,0.597274323261879,0.611453636429730,0.624674612052714,0.635764098973896,0.646393379230134,0.655574644494847,0.664211497533030,0.671989380583723,0.679094084472710,0.615463201450003,0.626246069729165,0.634932030009586,0.642525007105593,0.650118111485885,0.657711358206402,0.665304760691205,0.672776026651884,0.678356903383727,0.683950402915046,0.689543950826816,0.695137556797728,0.700731229954889,0.705757070625241,0.710158080446415,0.714559099743435,0.718960135408034,0.723361194010253,0.727762281761746,0.731327632464072,0.734782601454008,0.738237558179622,0.741692507342456,0.745147453444038,0.748417006845634,0.751214162349546,0.754014682278487,0.756815179622407,0.759615657664921,0.762416119601933,0.764872627408858,0.767188651086361,0.769504746603916,0.771820915621964,0.774137159790304,0.776423164789221,0.778362144478803,0.780305683559733,0.782249276843040,0.784192925574616,0.786136630972713,0.787934324586430,0.789586210991948,0.791238138109789,0.792890106887281,0.794542118290239,0.796194173261974,0.797634830519466,0.799053813117324,0.800472827466686,0.801891874328305,0.803310954430979,0.804672239430653,0.805901054423920,0.807131213171779,0.808361396560016,0.809591605163246,0.810821839576647,0.811940824621438,0.813016234623006,0.814091402188941,0.815166473149741,0.816241541721784,0.817302626121789,0.818244724783239,0.819188646056583,0.820132562014414,0.821076473049003,0.822020379539228,0.822898205837987,0.823712252197440,0.824527101460478,0.825341947101507,0.826156789160027,0.826971627665976,0.827743434345180,0.828511400398258,0.829279368363890,0.830047339165563,0.830815313728262,0.831552596077182,0.832218131129139,0.832884951442342,0.833551764928393,0.834218571848044,0.834885372448919,0.835502565631537,0.836099729868625,0.836696886931307,0.837294037017437,0.837891180312373,0.838479449226852,0.839016904524811,0.839555071675978,0.840093236244874,0.840631398388746,0.841169558267565,0.841683439245534,0.842169987054530,0.842656813699721,0.843143637394578,0.843630458258322,0.844117276426710,0.844564667346711,0.845006285121567,0.845447899604788,0.845889510904992,0.846331119123381,0.846762466312826,0.847163804247953,0.847565467363345,0.847967127068860,0.848368783454763,0.848770436612776,0.849148952161113,0.849515090438787,0.849881339132346,0.850247584362990,0.850613826204210,0.850978689894356,0.851313083347004,0.851647673809855,0.851982306792481,0.852316954595345,0.852651617254318,0.852973533197913,0.853279910494154,0.853586329348549,0.853892761556241,0.854199207144677,0.854505666140582,0.854789279716733,0.855069252871210,0.855349226964886,0.855629210896085,0.855909204676849,0.856183172461567,0.856441320333071,0.856699390219053,0.856957469925131,0.857215559463664,0.857473658846221,0.857715611736389,0.857950218090303,0.858184740006242,0.858419274575545,0.858653821818981,0.858883621301412,0.859072568054326,0.859260516075115,0.859448568221392,0.859635303545471,0.859824187027032,0.860035888072363,0.860264641875160,0.860492938734023,0.860721270237450,0.860949636830882,0.861178038960622,0.861364514240626,0.861550469752809,0.861735928643480,0.861921386873526,0.862106844464576,0.862286805033831,0.862457855146021,0.862628588684211,0.862799321485601,0.862970053553291,0.863140784886122,0.863300941694656,0.863457921089206,0.863614677917634,0.863771433808282,0.863928188775449,0.864082911895153,0.864227805455020,0.864372724858192,0.864517423620631,0.864662121337020,0.864806818004674,0.864945093565107,0.865086092901176,0.865218268229573,0.865350486063505,0.865482747672160,0.865615054292489,0.865738162379672,0.865860659311273,0.865982929949214,0.866105254288984,0.866227633407348,0.866345515190709,0.866457130947986,0.866568212795506,0.866679352340551,0.866790550773854,0.866901809427304,0.866986657131632,0.867069172322733,0.867149751149078,0.867230393590999,0.867311107447268,0.867402165138323,0.867521357796890,0.867639498133634,0.867759002076645,0.867878600917662,0.867998284672783,0.867588099874699,0.868163385933061,0.868237755768354,0.868298183398518,0.868373213254813,0.868453114843259,0.868547757484817,0.868641283507367,0.868736714975796,0.868832181329982,0.868927682364765,0.868389807646392,0.869085904141168,0.869163286199426,0.869238431789363,0.869313570172542,0.869388538780435,0.869456247627792,0.869524930348795,0.869592596270901,0.869660250486497,0.869727892365048,0.869793276914230,0.869855525044701,0.869918263033493,0.869980349298041,0.870042419310607,0.870104472154640,0.870162183129480,0.870219643198770,0.870276236573784,0.870332807904793,0.870386523609743,0.870442026113532,0.870493504842728,0.870545589222435,0.870596833597561,0.870648045595147,0.870699223304434,0.870025068812421,0.870066512388449,0.870112891493934,0.870154616019114,0.870195981753431,0.870235644305385,0.870270929208395,0.870309249063541,0.870343660051798,0.870377539591215,0.870408381198276,0.870434966109061,0.870457075664276,0.870484837510381,0.870506023378145,0.867293581179746,0.867267430659348,0.867247653971607,0.867201842166391,0.867401636911459,0.867600372474175,0.867188202568043,0.867067148769012,0.866906297047381,0.866321123443790,0.866350108159688,0.856652291344938,0.845940312543450,0.849430325811415,0.852439318266533,0.850775039973918,0.851777672237986,0.850706504220889,0.851811332312521,0.851772882887628,0.851760864412438,0.851840951091575,0.852165497561496,0.852569149791098,0.852940375973785,0.853014088111814,0.852271087402842,0.852588854257478,0.852784972382438,0.852730217638943,0.871993141683429,0.852857070583889,0.852671356613556,0.853032858580868,0.853118650763962,0.853190915226390,0.853263080744635,0.872458260070469,0.853425479583443,0.853495068614965,0.853568235018695,0.853636720327625,0.853727765874421,0.853799857139601,0.853913906772654,0.854163497999771,0.872068631512103,0.872133836781902,0.872194458453291,0.857398968308340,0.857170967895303,0.854341160073729,0.856572853483782,0.856630807578207,0.857516000928932,0.858042184292534,0.857983459139865,0.857361875126557,0.871664257900502,0.871718893924373,0.871766298319095,0.871805446715051,0.871840804866863,0.871872989147877,0.871904880083920,0.871931474667101,0.872538939721073,0.872555258622052,0.872557938951153,0.872560501741178,0.872561685325720,0.872562973281261,0.872563389675833,0.872563726675783,0.872563991392912,0.872564190328528,0.872562043559781,0.872559341340210,0.872556122168568,0.872552859275434,0.872549556388681,0.872540727974914,0.872525575947956,0.872500891193455,0.872476261403819,0.872451688731440,0.872427175163590,0.872121926214112,0.872419774867549,0.872433455359834,0.872447088015351,0.872460674547646,0.872474216491524,0.872472751003652,0.872467688901539,0.872458735192763,0.872443756223925,0.872428446172768,0.872407621002042,0.872382230678522,0.872345823583987,0.872309537092954,0.872273382541061,0.872237370263624,0.872221455435698,0.872213267946961,0.872212025532415,0.872210701526285,0.872209303433173,0.871513948705049,0.872184969642830,0.872170429253859,0.872150750261189,0.872131116912334,0.872111513276105,0.872088985958288,0.872068305631679,0.872045846162185,0.872023452942917,0.872001127197192,0.871978141996461,0.871954991913499,0.871932051651924,0.871908724635826,0.871885467372240,0.871864183521747,0.871845386969192,0.871827333400106,0.871808554755363,0.871789777574473,0.871771002077801,0.871751628949245,0.871731452785818,0.871712222357719,0.871692038748265,0.871671857315497,0.871651678153350,0.871630473561179,0.871609317593060,0.871588292314424,0.871566737654998,0.871545185955200,0.871523565288566,0.871500583390526,0.871478598174753,0.871455633058372,0.871432671584390,0.871409713741547,0.871386168791319,0.871361566571034,0.871338136040225,0.871313584986293,0.871289039320295,0.871264499098408,0.871239611528751,0.871214778118649,0.871189988585816,0.871164869026840,0.871139755381787,0.871114647599964,0.871088453276943,0.871063105234534,0.871036865430553,0.871010630891170,0.870984401670848,0.870957896403271,0.870930968426849,0.870904084256035,0.870876721806684,0.870849364192384,0.870822011308128,0.870794175536706,0.870766280228386,0.870738417626500,0.870710171408402,0.870681929831795,0.870653692833941,0.870624538859153,0.870596143399210,0.870566803416951,0.870537468178584,0.870508137626501,0.870478726167984,0.870455490321142,0.870424834842850,0.870393774313691,0.870362716662413,0.870331661930481,0.870300072998840,0.870268880033703,0.870236375299724,0.870203874631261,0.870171378086836,0.870138885662462,0.870105800307863,0.870073287665997,0.870039895020171,0.870006505996485,0.869973120549856,0.869939738609941,0.869905891596268,0.869872061496121,0.869837768365956,0.869803479329350,0.869769194433630,0.869734644746804,0.869700385473813,0.869665197670569,0.869630014620662,0.869594836478790,0.869559663158181,0.869523978889501,0.869511717738155,0.869476688770932,0.869441666580117,0.869406650937046,0.869371641707134,0.869336485912216,0.869300960636738,0.869264758287872,0.869228560619273,0.869192367703593,0.869156179174004,0.869120198790806,0.869083086586092,0.869045978399155,0.869008874048075,0.868971773485946,0.868934527057297,0.868897584640617,0.868859748977468,0.868821916627848,0.868784087509946,0.868746261610970,0.868709188830291,0.868670412179245,0.868631638121729,0.868592866781116,0.868554097942729,0.868515331706128,0.868482168563499,0.868456700578142,0.868431027681589,0.868368221668933,0.868345045057535,0.868304830876392,0.868245514566104,0.868216016791723,0.868174701927080,0.868113865469811,0.868070826074001,0.868026896419316,0.867986078366580,0.867959062221312,0.867918783304390,0.867878467552450,0.867838115427296,0.867770426615839,0.867723076606716,0.867675729553286,0.867628385498434,0.867581044437705,0.867533706337950,0.867443044187006,0.867375679121759,0.867308321207303,0.867240970378773,0.867173626552228,0.867330301829282,0.867551185327231,0.867496960784117,0.867447011608361,0.867948651143215,0.877944112040972,0.876953621713918,0.878444732914790,0.877946525564931,0.878452540250261,0.868071900379940,0.877900050215604,0.878654354629607,0.878751546942969,0.878899900482489,0.879015526651406,0.878815308737859,0.879245923966543,0.874170740124317,0.876506463815056,0.876323315602699,0.876139763476582,0.875955852120546,0.875855685269998,0.875774160901921,0.875715962379846,0.875657774663801,0.875599601333104,0.875542331465964,0.875518539475268,0.875462776696075,0.875407030401754,0.875351302190973,0.875295593589037,0.875241802653571,0.875190004044983,0.875137241098093,0.875068999878227,0.875073530543078,0.875018541642318,0.874964333787194,0.874908016062065,0.874786879126999,0.874715261083966,0.874665679134134,0.874616161839551,0.874566611980412,0.874516859497364,0.874467128105332,0.874417417875062,0.874367728784542,0.874320939032500,0.874270371562835,0.874219823978371,0.874169296264760,0.874118788694681,0.874068300798492,0.874020222097998,0.873968982321041,0.873917760555958,0.873866556550701,0.873815370647877,0.873763818989535,0.873711940343305,0.873661093046213,0.873610262889882,0.873559449843827,0.873508653954871,0.873459592457092,0.873408524993311,0.873357264123934,0.873306019597215,0.873254792496524,0.873208273931885,0.873167994503338,0.873116113976201,0.873060752504645,0.873001808253892,0.872942894045280,0.873054342898640,0.873042202381010,0.873093391811534,0.873175852125547,0.873258307879723,0.873340738966806,0.873423134172472,0.873507087210802,0.873589629799464,0.873672182830171,0.873754746319869,0.873837321403697,0.873920483397492,0.874003252332230,0.874053882403640,0.874094742396411,0.874135604781965,0.874176469546906,0.874217336574077,0.874258205052952,0.874299077012572,0.874339951303718,0.874380827926327,0.874421706508695,0.874462587754322,0.874503422376507,0.874544307391934,0.874585195369514,0.874626086309765,0.874666980001703,0.874707876830764,0.874748776615258,0.874789705835131,0.874830610722836,0.874871518569116,0.874912429948398,0.874953343914670,0.874994260871428,0.875035180816894,0.877655919732138,0.877705543503164,0.877757470267905,0.877807121306304,0.877856702182492,0.877906402201129,0.877956128499744,0.878005891087697,0.878055670457245,0.878105476495985,0.878151910245805,0.878182205148752,0.878212245191239,0.878242268952295,0.878272274456959,0.878302262854450,0.878332234250795,0.878362220160056,0.878392145485965,0.878422067916765,0.878451973499052,0.878481862127635,0.878511734143599,0.878552393588404,0.878582496744875,0.878611834229748,0.878641180890476,0.878670541132620,0.878699911581803,0.878729292703655,0.878758825586947,0.874880925629334,0.884678795761677,0.884873677002155,0.884723766839778,0.874694852226850,0.884920518946440,0.877484457866771,0.874519287570211,0.884922347134714,0.877095629274446,0.874642125747270,0.874378710706141,0.884803266108780,0.876593791580296,0.884792884372614,0.884672259510884,0.884556773558183,0.884690158673583,0.884562861392165,0.884623884927394,0.884517776130563,0.884589087720081,0.884535144828207,0.884491812777940,0.884382784306485,0.884360752537238,0.884461080314129,0.884446371475184,0.884432970489422,0.884416428612011,0.884382032719304,0.884357200815842,0.884309202307752,0.884264774251243,0.884201957085924,0.884098824407577,0.884038996423239,0.883980142976170,0.883912281349196,0.883839152096811,0.883766896015853,0.883695009385210,0.883622433610929,0.883550168345308,0.883477323913027,0.883405268286906,0.883332755553059,0.883260362714223,0.883188037122478,0.883115611345156,0.883043185304877,0.882970708569410,0.882898325103796,0.882825846406497,0.882753411588569,0.882680949220114,0.882608463494385,0.882536118094942,0.882463783087200,0.882423629482842,0.882392582003022,0.882361675697336,0.882330999902779,0.882300133969511,0.882269206033775,0.882238204777986,0.882206446533897,0.882175670437496,0.882145459457594,0.882114398333048,0.882083586943950,0.882051699146989,0.882021697645689,0.881990948425241,0.881960014391513,0.881929093425683,0.881898160384991,0.881867029260699,0.881836219687504,0.881805366062283,0.881774492711291,0.881743559163667,0.881712678101027,0.881681534576374,0.881650545330829,0.881615162451070,0.881576486376126,0.881537494966267,0.881499029608611,0.881460321540937,0.881421473519595,0.881382926541051,0.881343937152853,0.881305321778796,0.881265971272772,0.881228033659623,0.881188627894286,0.881150623804208,0.881111956095211,0.881073256407748;];
%speed and torque indices
BAS_Speed_Index_rads=[0,26.1799387799149,52.3598775598299,78.5398163397448,104.719755119660,130.899693899575,157.079632679490,183.259571459405,209.439510239320,235.619449019235,261.799387799149,287.979326579064,314.159265358979,340.339204138894,366.519142918809,392.699081698724,418.879020478639,445.058959258554,471.238898038469,497.418836818384,523.598775598299,549.778714378214,575.958653158129,602.138591938044,628.318530717959,654.498469497874,680.678408277789,706.858347057703,733.038285837618,759.218224617533,785.398163397448,811.578102177363,837.758040957278,863.937979737193,890.117918517108,916.297857297023,942.477796076938,968.657734856853,994.837673636768,1021.01761241668,1047.19755119660,1073.37748997651,1099.55742875643,1125.73736753634,1151.91730631626,1178.09724509617,1204.27718387609,1230.45712265600,1256.63706143592;];
BAS_belt_Eff=0.95; %static efficiency of the belt
BAS_belt_ratio=1.68; %ratio of the BAS belt system

BAS_Windage_Loss_Nm=[0,-0.287569908169872,-0.326839816339745,-0.366109724509617,-0.405379632679490,-0.444649540849362,-0.483919449019235,-0.523189357189107,-0.562459265358979,-0.601729173528852,-0.640999081698724,-0.680268989868597,-0.719538898038469,-0.758808806208341,-0.798078714378214,-0.837348622548086,-0.876618530717959,-0.915888438887831,-0.955158347057704,-0.994428255227576,-1.03369816339745,-1.07296807156732,-1.11223797973719,-1.15150788790707,-1.19077779607694,-1.23004770424681,-1.26931761241668,-1.30858752058656,-1.34785742875643,-1.38712733692630,-1.42639724509617,-1.46566715326604,-1.50493706143592,-1.54420696960579,-1.58347687777566,-1.62274678594553,-1.66201669411541,-1.70128660228528,-1.74055651045515,-1.77982641862502,-1.81909632679490,-1.85836623496477,-1.89763614313464,-1.93690605130451,-1.97617595947439,-2.01544586764426,-2.05471577581413,-2.09398568398400,-2.13325559215388;];
BASSpd_rads=EngSpd_rpm*(pi/30)*BAS_belt_ratio;
BAS_losses_W=-1*(interp1(BAS_Speed_Index_rads,BAS_Windage_Loss_Nm,BASSpd_rads)*BASSpd_rads)/BAS_belt_Eff; %parasitic power lost to the BAS

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vector_length=length(P_elec);
regen_penalty=zeros(1,vector_length);
constraint_penalty=zeros(1,vector_length);

switch regime
    case 1
        
        if P_req<0 %braking
            P_RTM=P_elec*RTM_Eff_par;
            P_RTM=round(P_RTM/3600)*3600;
            P_Brake=double(P_req)-double(P_RTM);
            P_gen=zeros(1,vector_length);
            P_BAS=zeros(1,vector_length);
            P_ICE=zeros(1,vector_length);
            fuel_in=zeros(1,vector_length);
            EngTrq_Nm=zeros(1,vector_length);
            %alpha=5e5; %
            alpha=1e-3;
            beta=5e7;
            regen_penalty=zeros(1,vector_length);
            %regen_penalty=alpha.*abs(P_Brake).*abs(E_final-E_grid(E_state_target));
            if P_req~=0
                regen_penalty=beta.*abs(P_Brake);
            else
                regen_penalty=alpha.*abs(P_elec);
            end
            
            %             if limited_regen
%                 alpha=5e3;
%                 regen_penalty=alpha*abs(P_Brake)*abs(E_final-E_state_target);
%             else
%                 alpha=5e3;
%                 regen_penalty=alpha*abs(P_Brake);
% %             end            
            
        else %motoring
            P_RTM=P_req; %in series regime, RTM supplies all power to the road.
            P_RTM_in=P_RTM/RTM_Eff_par; %electrical input power to the RTM
            P_RTM_in=round(P_RTM_in/3600)*3600;
            P_gen=double(P_RTM_in)-double(P_elec); %find the power required from the generator (ICE AND BAS)
            
            %apply penalties 
            regen_penalty(P_gen>DP_SIM_DATA.BAS.P_BAS_max)=Inf;
            regen_penalty(P_gen<0)=Inf;
            EngTrq_Nm=zeros(1,vector_length);
            P_ICE=-1.*ones(1,vector_length);
            fuel_in=zeros(1,vector_length);
            
            %create generator data index array, set zero-level ICE power points
            P_gen_index=roundn(P_gen,2)/100;
            P_gen_index(P_gen_index>P_Gen_opt_map(1,end)/100)=P_Gen_opt_map(1,end)/100;
            P_gen_index(P_gen_index<=0)=1;
            P_ICE(P_gen_index==0)=0;
            P_ICE(P_gen_index>P_Gen_opt_map(1,end))=-1;
            

            N_ICE_k=P_Gen_opt_map(2,P_gen_index); %cell array version
            EngTrq_Nm=P_Gen_opt_map(3,P_gen_index);
            fuel_in=P_Gen_opt_map(4,P_gen_index);
            P_ICE=N_ICE_k.*EngTrq_Nm*(pi/30);
            
                %if limited_regen
                %   alpha=5e1;
                %else
                %alpha=5e4; %5e1
                %end
                %regen_penalty=alpha*abs(P_gen); %this penalty for full regen
                %regen_penalty=0;
            
            P_Brake=repmat(-0.1,1,vector_length);
        end
        
        
    case 2 %parallel
        if P_req<=0 %braking or stationary
            P_RTM=P_elec*RTM_Eff_par;
            P_RTM=round(P_RTM/3600)*3600;
            P_Brake=double(P_req)-double(P_RTM);
            EngTrq_Nm=zeros(1,vector_length);
            P_ICE=zeros(1,vector_length);
            P_gen=zeros(1,vector_length);
            fuel_in=zeros(1,vector_length);
            %             if limited_regen
            %                 alpha=5e1;
            %             else
            %                 alpha=5e3; %5e3 works for full regen
            %             end
            %regen_penalty=alpha*abs(P_Brake)*abs(E_final-E_state_target);
            alpha=1e-3;
            regen_penalty=zeros(1,vector_length);
            if P_req~=0
                regen_penalty=abs(P_Brake);
            else
                regen_penalty=alpha.*abs(P_elec);
            end
            
            %             if E_final<E_state_target
            %                 target_state_coeff=5e2; %5e2 full regen, 5e8 limited regen
            %
            %                 regen_penalty=regen_penalty+((target_state_coeff*exp((k/T)))*abs(E_final-E_state_target)); %state variable penalty, proportional to distance from target value and distance from final stage.
%             else
%                 regen_penalty=regen_penalty+0;
%             end

        else %motoring
            P_RTM=P_elec*RTM_Eff_par;
            P_RTM=round(P_RTM/3600)*3600;
            P_ICE=double(P_req)-double(P_RTM); %find engine output power
            EngTrq_Nm=(P_ICE+(any(P_ICE)*BAS_losses_W))/EngSpd_rads; %find engine torque (including BAS parasitics)
            
            %             if limited_regen
            %                 target_state_coeff=5e2; %5e2 full regen, 7e7 limited regen
            %                 regen_penalty=target_state_coeff*k*abs(E_final-E_state_target); %state variable penalty, proportional to distance from target value and distance from final stage.
            %             else
            %alpha=5e2; %5e2 full regen
            %regen_penalty=alpha*abs(P_RTM-P_req); %this penalty for full regen
            regen_penalty=zeros(1,vector_length);
            %end
            P_Brake=repmat(-0.1,1,vector_length);
            P_gen=zeros(1,vector_length);
            P_BAS=zeros(1,vector_length);
            %fuel_in=interp2d(ICESpeedIndex_rpm,ICETorqueIndex_Nm,ICEFuelMap, EngSpd_rpm, abs(EngTrq_Nm)); %determine fuel power consumption from the fuel map
            fuel_in=interp2(ICESpeedIndex_rpm,ICETorqueIndex_Nm,ICEFuelMap, EngSpd_rpm, abs(EngTrq_Nm))';
            fuel_in(isnan(fuel_in))=Inf;
        end
        
        
    otherwise
        P_gen=0;
        P_BAS=0;
        P_RTM=0;
        fuel_in=0;
        P_Brake=0;
        P_ICE=0;
        P_elec=0;
end

%enforce physical constraints with static penalties
RTMTrq_Nm=P_RTM/RTM_speed_rads_par; %determine RTM Torque
% if EngTrq_Nm>ICE_Max_Torque_Nm %if ICE torque is over maximum...
%    constraint_penalty=constraint_penalty+Inf;
% end
% if EngTrq_Nm>Gen_max_torque
%    constraint_penalty=constraint_penalty+Inf;
% end

if regime==2

    fuel_cost=fuel_in;
    fuel_cost(P_ICE<0)=Inf; %apply penalties to the whole array. 
%     if (P_req==0)
%         fuel_cost(P_elec~=0)=Inf;
%     else
%     end

    constraint_penalty(abs(RTMTrq_Nm)>RTM_Max_Torque_Nm)=Inf;

else
    fuel_cost=fuel_in;
end

constraint_penalty(P_Brake>0)=Inf; %disallow positive braking power...
constraint_penalty(P_gen<0)=Inf; %disallow negative generator power...
constraint_penalty(P_RTM<DP_SIM_DATA.RTM.P_min)=Inf; %if RTM power is out of upper or lower bound...
constraint_penalty(P_RTM>DP_SIM_DATA.RTM.P_max)=Inf; 
constraint_penalty(P_ICE>DP_SIM_DATA.ICE.P_ICE_max)=Inf; %if ICE power is out of upper bound...
constraint_penalty(P_gen>DP_SIM_DATA.BAS.P_BAS_max)=Inf; %if BAS power is out of upper bound...
if P_req~=0
    constraint_penalty(sign(P_RTM)==(-1*sign(P_req)))=Inf; %if the algorithm is trying to drag the RTM to recharge the ESS, or propel the car during braking...
else
    constraint_penalty(any(sign(P_RTM),1))=Inf;
end
%total cost
total_cost=abs(fuel_cost+regen_penalty+constraint_penalty); %add penalties to the fuel cost

end %end of cost function





function f=ICE_costfunction(N_T)

ICESpeedIndex_rpm= [0,100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200,6300,6400;];
ICETorqueIndex_Nm = [0;10;20;30;40;50;60;70;80;90;100;110;120;130;140;150;160;170;180;190;200;210;220;];
%engine fuel map data - this is the input power (in W) from the fuel as a
%function ICE torque and speed - must convert this to grams or L of fuel
ICEFuelMap = [0,0,0,0,0,0,5601.34482800000,6580.33505000000,7649.66174200000,8726.76061300000,9700.01426500000,10555.7704200000,11421.5878000000,12499.4827300000,13573.8439400000,14960.1219000000,16395.6912600000,17297.2292000000,18250.7602300000,19642.6129300000,21138.6482200000,22446.6494900000,23791.9830100000,24813.3924000000,25956.4573300000,27023.7131900000,27985.0570500000,28946.4009200000,29907.7447800000,31274.3841700000,32698.6880100000,34134.7786100000,35570.8692100000,37275.5184800000,38980.1677500000,40387.5500700000,41722.2196100000,43073.2836900000,44445.7905700000,46106.2435700000,47766.6965700000,49219.5485800000,50672.4005800000,52125.2525800000,53796.7178600000,55714.1436200000,57631.5693800000,59548.9951300000,61515.4370800000,63686.4019000000,65946.0873400000,68205.7727800000,70465.4582200000,72781.0673200000,75043.5866300000,77258.8609100000,79474.1351800000,82476.8424700000,85479.5497600000,88310.5141300000,90989.9406100000,93482.7690400000,95975.5974700000,98744.1652800000,101540.847700000;0,0,0,0,0,0,5601.34482800000,6580.33505000000,7649.66174200000,8726.76061300000,9700.01426500000,10555.7704200000,11421.5878000000,12499.4827300000,13573.8439400000,14960.1219000000,16395.6912600000,17297.2292000000,18250.7602300000,19642.6129300000,21138.6482200000,22446.6494900000,23791.9830100000,24813.3924000000,25956.4573300000,27023.7131900000,27985.0570500000,28946.4009200000,29907.7447800000,31274.3841700000,32698.6880100000,34134.7786100000,35570.8692100000,37275.5184800000,38980.1677500000,40387.5500700000,41722.2196100000,43073.2836900000,44445.7905700000,46106.2435700000,47766.6965700000,49219.5485800000,50672.4005800000,52125.2525800000,53796.7178600000,55714.1436200000,57631.5693800000,59548.9951300000,61515.4370800000,63686.4019000000,65946.0873400000,68205.7727800000,70465.4582200000,72781.0673200000,75043.5866300000,77258.8609100000,79474.1351800000,82476.8424700000,85479.5497600000,88310.5141300000,90989.9406100000,93482.7690400000,95975.5974700000,98744.1652800000,101540.847700000;0,0,0,0,0,0,7224.53255000000,8298.57996000000,9492.10160200000,10723.7019000000,11795.7351500000,12799.7009300000,14291.2493100000,15508.0468300000,16715.3304700000,18283.7580800000,19863.6108400000,21206.0307100000,22652.0399700000,23997.3543200000,25333.7834900000,26875.4940500000,28254.0181700000,29748.8645400000,31288.5259800000,32508.6110100000,33728.6960400000,34948.7810700000,36168.8661000000,37623.7206100000,39078.5751100000,40533.4296200000,41988.2841300000,43926.8777500000,45865.4713700000,47721.2898400000,49480.9503500000,51274.7365600000,53068.5227700000,54981.7955300000,56917.7445600000,58691.9767000000,60466.2088300000,62240.4409600000,64214.1621300000,66399.8161100000,68585.4701000000,70744.2692200000,72879.6786400000,75180.3217800000,77480.9649300000,79811.4551800000,82146.9900200000,84678.4842200000,87144.9654300000,89611.4466500000,92077.9278600000,95248.9837100000,98420.0395700000,101523.903400000,104607.344100000,108119.653700000,111631.963300000,114708.594700000,117505.277100000;0,0,0,0,0,0,9424.68628200000,10487.4241900000,11668.1423900000,12891.9300500000,14248.4551600000,15695.7096600000,17160.9108200000,18647.6747600000,20192.7092900000,21904.5257300000,23626.7412700000,25309.4976600000,26968.0120100000,28528.5541800000,30064.3625200000,32070.3910200000,33853.6626000000,35300.1816900000,36762.3083100000,38276.3191500000,39639.4207200000,41002.5222900000,42365.6238500000,44131.7569800000,45842.1402300000,47529.4271000000,49216.7139800000,51353.4847000000,53490.2554100000,55573.9631800000,57567.8176800000,59586.8834100000,61696.4041200000,63927.7375300000,66159.0709400000,68349.3483000000,70539.6256500000,72729.9030000000,74794.9546400000,77129.6668200000,79560.5142400000,81991.3616700000,84422.2091000000,86991.7875300000,89561.3659500000,92099.2969800000,94434.8318100000,97144.6895700000,99854.5473200000,102564.405100000,105210.094200000,108699.723500000,112435.781200000,116171.838900000,119907.896600000,124601.636000000,128587.434100000,131956.713700000,135325.993300000;0,0,0,0,0,0,11751.0068100000,12970.3002000000,14367.3071900000,15780.6482300000,17191.1005200000,18707.5912800000,20200.6526800000,21960.3012200000,23679.0618500000,25534.2399800000,27309.0506400000,29186.6368600000,31204.6558900000,32983.1977700000,34672.5606300000,36837.8151300000,38937.8982800000,40505.8718400000,42217.6132000000,44152.2921600000,45809.5915100000,47413.1271400000,49016.6627800000,50900.2475200000,52783.8322600000,54624.8053100000,56454.3737600000,58599.0830100000,61032.4180400000,63465.7530800000,65899.0881100000,68196.7797400000,70494.4713700000,72877.8293200000,75599.0933100000,78196.2113400000,80793.3293800000,83224.2309200000,85592.5353800000,88113.5939600000,90676.0789200000,93382.0406300000,96088.0023300000,98990.2481100000,101857.620800000,104509.752100000,107161.883400000,110489.432800000,113816.982300000,116750.004700000,119618.426200000,123888.690400000,128158.954500000,132429.218700000,136282.541200000,140976.280700000,145670.020100000,150363.759600000,154826.206900000;0,0,0,0,0,0,13848.5167300000,15444.0235700000,16949.6415500000,18335.2468900000,19782.0283600000,21146.3391700000,22542.4283100000,24501.8507800000,26555.5519400000,28873.4297900000,30931.2062000000,33078.8187300000,35275.5339000000,37259.3314400000,39251.7583100000,41535.4550700000,43815.7665800000,45638.0884000000,47774.8086600000,49948.5673800000,51969.2520900000,53908.6978700000,55848.1436500000,58115.7014100000,60209.0938800000,62231.5114800000,64253.9290800000,66768.8197500000,69283.7104100000,71798.6010800000,74314.9052800000,77020.6855300000,79726.4657700000,82432.2460200000,85188.1996000000,88018.2382200000,90776.5266100000,93534.8150100000,96293.1034000000,99095.7047800000,101898.306200000,104867.223600000,107887.737500000,111271.592000000,114225.555200000,117179.518300000,120133.481500000,124559.862900000,128278.693900000,131540.057000000,134801.420100000,139512.844100000,144022.971500000,148476.318400000,152929.665300000,158772.727000000,164575.141500000,169380.388500000,174185.635400000;0,0,0,0,0,0,15290.4835300000,17545.8640200000,19536.5811700000,20860.9554400000,22092.6715300000,23636.8603600000,25158.6527100000,27425.0710600000,29745.1408500000,32254.7239700000,34727.8519900000,37092.1568900000,39328.6392200000,41609.6119400000,43865.5504200000,46287.4755400000,48725.4637800000,51191.0699200000,53697.9842900000,55911.9641700000,58102.9954000000,60293.4696200000,62483.9438400000,64765.3853300000,67166.2589600000,69609.8801600000,72053.5013600000,74660.2406800000,77266.9800000000,79849.5117600000,82406.2093700000,85749.5802300000,88658.6571500000,91567.7340700000,94476.8109900000,97403.3062700000,100329.801600000,103616.374500000,106950.589600000,110226.184200000,113501.778800000,116607.408900000,119627.922800000,123067.356100000,126506.789300000,129946.222600000,133101.927600000,137528.309100000,141954.690500000,146381.071900000,150816.810700000,155531.076600000,160242.500700000,164953.924800000,169655.443200000,175660.207500000,181724.941000000,187789.674600000,193854.408100000;0,0,0,0,0,0,16712.9395000000,18976.6615700000,21432.7785000000,22725.8612800000,24050.2807500000,26066.1814100000,28111.0452200000,30640.8666400000,33161.3695400000,35817.9575200000,38535.3396500000,41080.0588400000,43483.0988800000,45929.6350100000,48549.2898000000,51243.4448800000,53912.1446300000,56628.8773200000,59380.9177200000,61678.2380300000,63975.5583300000,66288.1477100000,68902.3404800000,71465.5008100000,74028.6611400000,76591.8214700000,79264.0415000000,82217.6733500000,85050.7034400000,87883.7335300000,90716.7636100000,94265.2897200000,97565.1145200000,100764.949800000,103964.785000000,107362.909700000,110761.034400000,114159.159100000,117663.629500000,121130.458000000,124556.565400000,127982.672800000,131408.780300000,134851.012700000,138427.761100000,142248.609400000,146069.457700000,151595.231900000,156996.958100000,161560.775500000,166124.593000000,172291.905800000,178459.218600000,183767.279800000,188466.005200000,195267.699600000,202069.394100000,208798.965000000,214863.698500000;0,0,0,0,0,0,18002.6388600000,20557.8843500000,23066.3054800000,24482.6447200000,26439.3111700000,28903.5474000000,31036.8250400000,33602.6944600000,36601.3885700000,39387.8312200000,42350.5384100000,44903.0767400000,47746.8645800000,50713.2933100000,53368.3587300000,56047.3474400000,58743.8972100000,61695.9438100000,65198.7929000000,67550.6456400000,69902.4983700000,72823.9886400000,75926.3666100000,78489.5269400000,81052.6872700000,83615.8476000000,87270.5874800000,90757.6919800000,94143.7517600000,96976.7818400000,99809.8119300000,103358.338000000,106906.864100000,110455.390200000,113785.030100000,117244.591000000,121136.720300000,125028.849700000,128920.979000000,132431.142500000,135992.541600000,139585.904100000,143179.266500000,147084.734900000,150990.203300000,154895.671700000,159102.317100000,165290.101200000,170747.825100000,176205.549000000,181663.272900000,188375.235800000,194776.512800000,201177.789700000,207579.066700000,216604.671600000,224605.028900000,231952.645300000,239300.261700000;0,0,0,0,0,0,19290.1795700000,21929.4624100000,24744.2402900000,27025.8134700000,28982.4799300000,31509.2730600000,33962.6048700000,36954.5523100000,40046.1428400000,43115.6456200000,46210.0327900000,48954.5731900000,52070.1320700000,55433.2019500000,58187.4276600000,60866.4163600000,63545.6133100000,67348.3178800000,71164.9963000000,73643.2588500000,76745.6368100000,79848.0147700000,82950.3927300000,85513.5530600000,88076.7133900000,91494.4203600000,95277.1334600000,98764.2379500000,102251.342500000,105738.446900000,108902.860200000,112451.386400000,116135.509300000,119852.013600000,123568.517800000,127439.791500000,131575.258400000,135884.338100000,140193.417700000,143933.951400000,147674.485100000,151313.304200000,154906.666600000,158812.135000000,163222.471200000,167818.665300000,172414.859400000,179486.400600000,186557.941800000,193360.513400000,198818.237300000,206004.306800000,213190.376300000,220376.445800000,227219.518100000,236245.123000000,245993.556300000,255831.934400000,265670.312400000;0,0,0,0,0,0,20821.2746800000,23497.1651200000,26487.1461700000,28952.3796800000,31530.7141500000,34298.0021500000,37000.0467300000,40466.4161000000,43563.0744000000,46782.5052100000,50090.4852600000,53277.8406700000,56393.3995500000,59756.4694300000,63006.4965800000,66063.3952300000,69347.0398300000,73207.8296600000,77072.8740000000,80667.2849700000,83769.6629400000,86872.0409000000,89974.4188600000,92537.5791900000,95718.2532500000,99500.9663400000,103283.679400000,106770.783900000,110257.888400000,113765.012900000,117992.856700000,121727.692700000,125462.528700000,129197.364700000,133408.430600000,137835.163800000,142261.896900000,146688.630000000,151484.090000000,155645.491800000,159454.283200000,163263.074700000,167071.866100000,171679.114700000,176286.363300000,180957.002800000,186318.384800000,194310.688100000,201812.163000000,209033.064100000,216253.965200000,225597.733200000,234709.076600000,242454.925600000,250200.774700000,260650.951500000,271101.128300000,281551.305100000,291852.197700000;0,0,0,0,0,0,22645.2788300000,25291.5360200000,28256.6169100000,31202.5643100000,34111.4049300000,37354.2450000000,40064.0221300000,43574.7751400000,47084.6130200000,50569.2487900000,54054.7700600000,57246.2537700000,60912.3665800000,64274.8068000000,67950.8541000000,71876.9639800000,75160.6085800000,79022.9238100000,82896.8196200000,86678.4431500000,90460.0666800000,93896.0670300000,96998.4449900000,99942.0861300000,103724.799200000,107507.512300000,111290.225400000,114777.329900000,118625.876200000,122853.720100000,127081.563900000,130816.399900000,134812.562000000,139055.043100000,143297.524300000,147724.257400000,152426.815500000,157620.169200000,162813.522800000,167056.879000000,171300.235100000,175543.591300000,179778.683100000,185126.949800000,190488.331800000,195849.713800000,201211.095900000,209203.399100000,217280.948300000,225358.960700000,233436.973100000,243018.740400000,252974.982900000,262931.225400000,272887.467900000,284320.644300000,294808.549300000,305296.454300000,315784.359200000;0,0,0,0,0,0,24357.1419300000,27212.8205700000,30349.0604700000,33546.9434300000,36692.0957000000,39934.9357700000,43127.9975300000,46850.8330200000,50622.4830200000,54320.1293700000,58019.7521300000,61754.1935100000,65487.4996300000,69187.9205400000,72932.2139500000,77001.4637500000,80974.1773300000,84846.8694200000,88720.7652400000,92502.3887700000,96284.0123000000,100065.635800000,103961.836200000,107943.911900000,111728.745000000,115513.578100000,119296.771400000,123486.739600000,127713.357700000,131938.723500000,136164.089300000,140390.925200000,144617.761100000,148844.597000000,153225.920100000,158562.894600000,163756.248300000,168949.602000000,174142.955700000,178386.311800000,182789.842500000,187402.866900000,192015.891300000,197251.374400000,202486.857600000,208647.346100000,216109.979700000,226628.533500000,235737.860900000,244186.038700000,252634.216500000,263717.816300000,274468.146200000,284424.388700000,294380.631200000,306165.402400000,317950.173700000,329095.157600000,339583.062500000;0,0,0,0,0,0,26069.0050200000,29177.0635400000,32526.1095800000,35957.8715500000,39320.8243800000,42563.7990900000,46240.1660300000,50388.7357500000,54160.3857500000,57858.0320900000,62216.4628800000,65970.7714300000,70165.0005100000,73940.1891700000,77891.6444900000,82272.7012000000,86379.7611200000,90519.3356900000,94544.7108600000,98408.7355300000,102462.675200000,106516.614900000,110570.554500000,114913.003400000,119255.452300000,123473.273600000,127258.106700000,131821.385600000,136384.664600000,140920.849100000,145146.214900000,149390.080900000,154068.214000000,158746.347000000,163424.480000000,168834.678600000,174244.877200000,179712.758500000,185320.853200000,190747.067300000,195024.216000000,199637.240400000,204250.264800000,209814.660200000,217277.293800000,224739.927400000,232202.561100000,242721.114900000,253239.668800000,263621.980700000,272070.158500000,283153.758200000,294237.358000000,305320.957700000,315873.794400000,327658.565600000,339443.336900000,351528.392900000,363878.565000000;0,0,0,0,0,0,27780.8681200000,31141.3065000000,38315.3378500000,38515.7324900000,41955.3693100000,45620.1404800000,49357.8684100000,53560.4338700000,57698.2884800000,62005.0028300000,66413.1736200000,70606.9095100000,74854.8957000000,78764.3580800000,82840.7553700000,87431.3390200000,91731.8084400000,95880.9284100000,100391.769300000,104530.377000000,108668.984700000,112807.592400000,117258.542700000,121612.920600000,125967.298500000,130321.676300000,135180.314700000,140222.984000000,144962.793400000,149566.286800000,154169.780200000,158962.536000000,163755.291700000,168548.047400000,173582.326500000,179405.070300000,185013.165000000,190621.259800000,196229.354500000,201655.568600000,207081.782800000,212507.997000000,218872.724500000,226316.071900000,233759.419300000,241202.766700000,248295.142500000,258813.696300000,269583.432400000,280366.358500000,291149.284600000,303814.256400000,315177.238400000,326540.220500000,337903.202500000,352709.799100000,366081.918900000,378432.091100000,390782.263200000;0,0,0,0,0,0,29492.7312100000,33105.5494700000,44104.5661200000,41073.5934400000,44823.7694100000,48687.5049000000,52570.6404700000,57489.8393400000,62006.4407600000,66492.9214500000,70922.1556000000,75208.1406600000,79622.3255500000,83705.9800700000,87781.3204200000,92373.6475600000,97318.9884200000,101735.365900000,106246.206800000,110384.814500000,114918.651900000,119521.224900000,124123.797900000,128478.175700000,133278.747800000,138171.512900000,143064.278000000,148106.947300000,153149.616500000,158192.285800000,163216.353200000,168304.112400000,173407.644600000,178511.176700000,183614.708800000,190185.428100000,196756.147300000,201529.761100000,207137.855800000,212564.069900000,219062.381500000,225563.547400000,232064.713300000,239508.060700000,246951.408200000,254604.606400000,264454.540700000,276570.417200000,287969.916000000,298752.842000000,309535.768100000,323324.663500000,337113.558800000,348756.085700000,360119.067700000,374925.664400000,389732.261000000,404538.857700000,417685.961400000;0,0,0,0,0,0,31204.5943000000,35069.7924300000,49893.7943900000,43631.4543800000,47692.1695000000,57416.8450000000,55942.5398700000,61401.0471000000,66454.8039400000,71031.7254500000,77055.6999600000,80633.5640300000,84530.0147200000,89366.8377200000,94793.2545800000,98321.4967400000,103510.795300000,107885.319500000,112251.742000000,116870.216500000,121488.691000000,126318.949100000,131168.989000000,136212.297100000,141162.711100000,146055.476200000,150948.241400000,155990.910600000,161285.487900000,167144.703300000,173003.918800000,178300.124700000,183440.026900000,188543.559000000,193647.091200000,200217.810400000,206788.529600000,213359.248900000,221053.155800000,227373.348900000,232254.370300000,238755.536200000,245256.702100000,252700.049600000,260923.268000000,270773.202300000,280623.136600000,292739.013100000,304854.889600000,316970.766100000,327922.251600000,341711.147000000,355500.042300000,369288.937700000,382334.932900000,397293.392100000,414093.183900000,430892.975800000,447692.767700000;0,0,0,0,0,0,32916.4574000000,37034.0354000000,55683.0226500000,46189.3153300000,50560.5695900000,66146.1851100000,70767.6374600000,69288.0090900000,73963.1081000000,79328.6338600000,85352.6083600000,88930.4724400000,93707.4519500000,100546.801900000,105973.218800000,109204.665600000,112552.817100000,117015.792000000,122002.952500000,126622.750300000,131242.548100000,135862.345900000,141196.957900000,143843.987800000,148863.380200000,153882.772500000,158902.164900000,165225.886700000,171085.102100000,176944.317500000,182803.533000000,188099.738900000,193395.944900000,198575.941400000,203679.473500000,210250.192800000,216995.892800000,225223.018300000,233450.143700000,239770.336900000,246090.530000000,252410.723100000,258448.691000000,267241.929700000,277091.864000000,286941.798300000,296791.732600000,309251.173700000,321928.277000000,334605.380200000,347282.483400000,364523.070800000,378968.542000000,393414.013100000,407859.484300000,426423.301200000,444987.118200000,462600.246800000,479400.038600000;0,0,0,0,0,0,34628.3204900000,38998.2783600000,61472.2509200000,48747.1762700000,53428.9696800000,74875.5252200000,85592.7350500000,77174.9710800000,83315.2228600000,87752.6946300000,93649.5167700000,97573.4831500000,103327.887300000,111018.740100000,117153.183000000,120443.195100000,123945.746200000,128408.721000000,134291.925500000,138911.723300000,143531.521100000,148946.303400000,155277.445200000,156143.716900000,157009.988500000,162017.489300000,167036.881700000,173623.241000000,180209.600400000,186743.931700000,192603.147200000,197899.353100000,203195.559100000,208491.765100000,213711.855900000,221165.755300000,229392.880800000,237620.006200000,245847.131700000,252167.324800000,258487.518000000,265369.730600000,275306.608400000,284080.346900000,294000.886400000,303921.426000000,313841.965600000,328330.404100000,342364.756700000,355041.860000000,367718.963200000,385189.044300000,402659.125400000,419734.948000000,434180.419200000,452744.236100000,471308.053100000,497083.258500000,524210.102400000;0,0,0,0,0,0,36340.1835900000,40962.5213300000,67261.4791900000,51305.0372100000,56297.3697700000,83604.8653200000,100417.832600000,85061.9330600000,92667.3376100000,96176.7554000000,101946.425200000,107193.918500000,112948.322700000,120639.175400000,128318.321300000,131836.124200000,135338.675300000,140584.792500000,146580.898500000,151200.696300000,156695.648800000,163026.790700000,169357.932600000,170224.204200000,171090.475800000,171956.747500000,175171.598500000,181757.957800000,188199.458100000,194295.728600000,200391.999100000,206545.955800000,214065.133200000,221584.310600000,229103.488000000,235565.649000000,242027.810000000,250016.994200000,258244.119700000,264564.312800000,274308.451900000,284245.329600000,294182.207400000,302895.049900000,311607.892300000,321019.038900000,330939.578400000,345428.017000000,359916.455500000,374404.894000000,388155.443000000,405625.524100000,425860.603400000,447799.368400000,469738.133500000,495659.232400000,520041.310300000,531566.270300000,569020.166300000;0,0,0,0,0,0,38052.0466800000,42926.7642900000,73050.7074600000,53862.8981600000,59165.7698600000,92334.2054300000,115242.930200000,92948.8950500000,102019.452400000,104600.816200000,110243.333600000,116814.353900000,122568.758100000,130259.610800000,139483.459600000,141568.438300000,147230.322200000,152873.765500000,158869.871500000,164444.994300000,170776.136200000,177107.278000000,183438.419900000,184304.691500000,185252.618700000,187575.081700000,189897.544800000,203489.227500000,216002.904700000,224151.875500000,232300.846400000,237261.994700000,242223.143000000,247157.381900000,251430.614100000,252045.787800000,258105.996200000,264171.470700000,270236.945100000,281169.677900000,292102.410600000,303035.143400000,313057.806400000,321770.648900000,330483.491300000,339196.333800000,348037.191300000,366218.809800000,386289.657100000,406360.504500000,426431.351800000,447990.647400000,468613.802700000,475863.788900000,505295.847800000,538574.228600000,568774.567500000,566049.282100000,613830.230100000;0,0,0,0,0,0,39763.9097800000,44891.0072600000,78839.9357200000,56420.7591000000,62034.1699500000,101063.545500000,130068.027800000,100835.857000000,111371.567100000,113024.876900000,118540.242000000,126434.789300000,132189.193500000,139880.046200000,150648.597900000,151300.752400000,159121.969100000,165162.738500000,171158.844500000,177689.292300000,184856.623500000,191187.765300000,192122.487400000,198926.446400000,204281.929700000,206604.392800000,208926.855800000,222518.538500000,236110.221200000,247776.115800000,252836.457800000,257896.799700000,263164.105400000,273372.668900000,283581.232500000,293297.671000000,294133.985100000,294970.299300000,295806.613400000,300566.078300000,305325.543100000,315390.473500000,326538.151900000,335512.657400000,345195.990700000,354879.324000000,364562.657400000,386201.630500000,427756.071000000,438316.114900000,464707.260600000,490355.770800000,511367.002000000,503928.209300000,540853.562100000,581489.224900000,617507.824700000,600532.293800000,658640.293900000;0,0,0,0,0,0,41475.7728700000,46855.2502200000,84629.1639900000,58978.6200500000,64902.5700500000,109792.885600000,144893.125400000,108722.819000000,120723.681900000,121448.937700000,126837.150400000,136055.224700000,141809.628900000,149500.481600000,161813.736200000,161033.066500000,171013.616100000,177451.711500000,183447.817500000,190933.590300000,198937.110800000,205268.252600000,200806.555000000,213548.201400000,223311.240800000,225633.703800000,227956.166800000,241547.849500000,256217.537700000,271400.356200000,273372.069200000,278531.604800000,284105.067700000,299587.955900000,315731.850900000,334549.554200000,330161.974000000,325769.127900000,321376.281700000,319962.478700000,318548.675600000,327745.803600000,340018.497400000,349254.665900000,359908.490100000,370562.314300000,381088.123500000,406184.451200000,469222.484900000,470271.725300000,502983.169400000,532720.894200000,554120.201300000,531992.629700000,576411.276300000,624404.221100000,666241.081900000,635015.305600000,703450.357700000;];
Gen_Fuel_Map=[0,0.00517745437189441,0.00270952474218591,0.00362283604040344,0.00430939486410812,0.00443187747660331,21797.9983311929,23384.7631492493,25296.0981881018,27278.6756211490,28946.2699864779,30309.4737101622,31756.1827744332,33810.4378390958,35859.0596208621,38723.6127069732,41688.1863015482,43298.3535913046,45062.3538611011,47902.2960540291,50986.7420671802,53612.6556902116,56314.8930376077,58250.1183952806,60475.3613299061,62524.9952624437,64330.7090464113,66140.0460613465,67954.0691036717,70688.0193703364,73546.3140880678,76424.5311780435,79299.5098268391,82768.3926945371,86230.9630669819,89041.0210587208,91697.9523091995,94398.1225045878,97157.1957017154,100557.938971888,103972.466545262,106959.824766264,109969.247341612,113001.669853668,116546.983147171,120662.126566973,124784.009286040,128730.323401032,132708.909099645,137120.893687190,141876.557682006,146730.386531026,151793.003184363,157544.164534324,163642.122596405,170043.121523302,176708.934820277,185471.638408997,194050.910283286,200826.869339786,207279.365967591,213417.043330988,219677.058234419,226731.240204398,233692.656090144;0,0.00294533333010744,0.00148994323745592,0.00175651565459402,0.00195317664521827,0.00199477789827480,10165.3296758285,11195.9745738994,12380.1290216547,13593.5482528449,14645.5496705988,15535.3826757911,16458.9427905552,17692.4070204721,18921.7170269706,20582.8651809454,22299.4705871690,23292.7917428211,24365.9602698873,26015.8773722484,27803.9725230911,29346.5141515853,30929.8151138924,32091.3062013948,33411.2405754457,34633.4873317011,35714.9683062498,36798.4531570558,37896.6399796701,39503.1136237686,41174.8278734362,42853.2440388632,44535.8781188357,46555.4321866148,48571.6354304827,50227.3608510725,51794.3525779980,53375.7239157418,54986.3874170862,56952.4715099349,58917.2454242445,60649.9005191558,62385.0580041752,64114.7681476701,66134.6015325534,68466.5955613114,70798.0456073321,73089.4793952488,75422.2339463244,78004.8092555027,80748.5998192030,83518.4416608343,86320.5563864305,89242.8435572602,92230.1468908739,95300.3565942392,98502.3354053969,102760.840885129,106963.263469856,110602.708526775,114061.001657247,117316.226059383,120605.412430452,124287.636317740,127960.591004919;0,0.00284850695220383,0.00141129685487000,0.00155408924059329,0.00166454869606323,0.00168739115283965,11303.5769740371,12336.3150032736,13567.2865975928,14878.7066335055,15974.1740071316,16995.3146662193,18672.6065313671,19985.6966497654,21289.7170129054,23053.5113684122,24824.7057643652,26298.8881522228,27904.0082450231,29382.9604330713,30853.7411075819,32576.3919404261,34099.4402425356,35762.6929576762,37478.9132403747,38811.7468419883,40138.4943510527,41466.6828424432,42811.3737368711,44428.6203238874,46037.7871987570,47636.3048880358,49242.4369332697,51419.5333257274,53595.9983525579,55688.7848595856,57668.8817530425,59676.3506127044,61686.2099186188,63829.0347680598,65989.7485297778,67999.8130644668,70003.8602844897,71986.8276539572,74243.6894862642,76750.3987771378,79246.1698805574,81690.8447773213,84090.0719687919,86677.8452607026,89338.5460496419,92031.4593314776,94727.8383022448,97696.5780685400,100635.679346463,103631.104006150,106703.644972453,110690.486987864,114674.888640666,118355.336996984,122017.615844100,126200.573140946,130407.199824141,134136.657741210,137508.503463493;0,0.00285447782160275,0.00139724433431294,0.00148263805911871,0.00155530582420206,0.00156758739777485,13818.4903416101,14693.9880844805,15790.3188468786,16994.1977018800,18383.8983428619,19901.0897880046,21451.3430229896,23027.1929111976,24677.2454069356,26532.6285143588,28393.7095003768,30211.3736155934,32004.9849128301,33670.2839721877,35312.3966402379,37511.1447365435,39441.9862401061,40979.9695990249,42537.6957431667,44156.9146503350,45601.0226561145,47047.1048918596,48499.9031476162,50413.0817908219,52259.7730520251,54076.2097430374,55893.8046537527,58222.5353390862,60551.5275300508,62831.8146541107,65011.2122534712,67210.4294488993,69513.4294595967,71945.2400252847,74365.1147891876,76779.8078106739,79186.2083585347,81566.8742398564,83854.8226327638,86447.6394014092,89135.6057795103,91822.1372623104,94491.5447138489,97312.2262812502,100216.385821017,103055.835527775,105641.445770998,108706.502769758,111798.713859456,114926.837993002,118047.099201483,122188.587684919,126608.375538370,130867.624474848,135133.189803494,140495.461521394,145079.321928603,148994.242375322,152883.786600502;0,0.00290222034931875,0.00140785439133078,0.00145483627496006,0.00150366995872478,0.00150816836930825,16655.5052980796,17620.7216926685,18897.0939337593,20254.0969486337,21626.8469327878,23154.4752396876,24672.9437869176,26520.1270654332,28319.1603377650,30282.4308566779,32146.2721976790,34136.5617786797,36295.9808746244,38168.4741267156,39946.8654786012,42280.0121171784,44529.0212005058,46167.6864378768,47970.7812709773,50027.0749294897,51763.1064718151,53439.3766074735,55128.4277123290,57129.7874568516,59127.2564273578,61072.6324851561,63010.6217284049,65302.9484577354,67915.9637543786,70534.3350794675,73152.2367256060,75614.3092088340,78080.3338495396,80637.9663593211,83562.8295945039,86371.5074226684,89177.8116408994,91790.6357818710,94362.6143503978,97107.9961823729,99899.0578439508,102874.002278605,105823.224614642,108968.030198896,112158.844426316,115073.235891135,117953.181823695,121649.998991520,125353.975992491,128641.797066829,131925.504546313,136819.905116699,141718.480599726,146488.371745301,150803.695867286,156064.407037214,161342.775745559,166646.384690655,171671.138088726;0,0.00296946800815904,0.00142996504266717,0.00144720923338377,0.00147819919645309,0.00147599925495599,19263.6537067007,20625.7333460808,21943.8597513539,23185.3979546412,24536.9543103836,25821.3721293088,27177.3500374068,29215.5573320796,31367.3263969946,33831.4414581629,35981.5165029727,38243.2856242211,40568.7166411782,42635.1616464421,44716.7323329442,47136.0997268562,49550.1015405002,51447.2287172951,53700.2242556541,55994.9554917241,58103.1129350647,60120.8717814885,62169.5702616174,64571.2642388518,66765.8965898620,68868.5509323428,70989.4001148918,73661.1019039822,76326.8018426214,78998.9064797661,81672.6972657061,84549.4097193484,87427.7821114738,90303.5688301920,93230.4564541841,96257.3464000133,99203.2271201561,102139.165938183,105095.571421877,108111.518569569,111139.425010183,114384.947748466,117668.113037946,121326.711944153,124572.528229434,127779.708028351,130958.755844371,135820.477131018,139915.480129893,143524.296976131,147189.255723369,152505.173001381,157609.927789448,162530.649781013,167457.860505135,173921.960733998,180359.179505992,185728.384163049,191075.038345044;0,0.00304730936954379,0.00145819821714112,0.00145012616014200,0.00146661608158177,0.00145849173033327,21051.1363092773,23212.8072415110,25072.3325038193,26160.5160428331,27185.3193526568,28640.2500136637,30103.1162346565,32465.6483078177,34888.3901717206,37528.6534140322,40118.5514728245,42590.3468476369,44924.6806035974,47293.3049372707,49643.4772638074,52190.4073290191,54743.1612822988,57325.0273720793,59953.5280288730,62258.4924964211,64532.0246292150,66808.5036224804,69107.8917257059,71499.0568354797,74009.1360500265,76548.3987750797,79101.6252695374,81842.3734172065,84585.2854951827,87318.2531275201,90021.4297178495,93565.8475608610,96632.5097968835,99696.7477717626,102761.188903268,105863.895833631,108963.997007092,112445.107171986,116000.738418341,119523.036788865,123076.177461445,126450.899756624,129713.411569585,133412.918922711,137158.089465427,140868.329863815,144247.103150317,149075.124983715,153915.482894420,158774.538676384,163697.358026415,168974.885376143,174251.634216991,179424.403627847,184593.875427504,191196.380216852,197881.321864444,204591.766222021,211279.525035474;0,0.00313159504375849,0.00149015377331142,0.00145954294145244,0.00146343318150371,0.00144971446491483,22890.3261327599,24985.0811440740,27381.2920433458,28374.5590384029,29468.6549526234,31454.0581895978,33501.7149766546,36124.3971422276,38736.5879921330,41510.1919704238,44341.0586598454,46979.2684453323,49465.9062842497,51992.4580293066,54725.6185787312,57551.5613054088,60339.5771415819,63175.7824860948,66047.1914533683,68412.3297108615,70774.0012597077,73157.1431176315,75892.5573651568,78566.2018993107,81232.8745726119,83890.9497487559,86676.7043179800,89772.8790378549,92734.1673069391,95723.4901490982,98714.7145964546,102463.337587648,105938.471889810,109293.463359177,112635.369402104,116239.197279384,119835.498445385,123404.266033887,127124.194737759,130847.905942423,134570.650448545,138288.029176542,141981.409604749,145670.694896177,149537.715129562,153643.846353432,157736.982047844,163737.999620939,169617.830942202,174609.719491650,179648.092890150,186469.149451924,193295.833370591,199101.564256313,204255.810571293,211704.876537663,219171.937000292,226588.299258633,233257.716553466;0,0.00322017373139207,0.00152450847791709,0.00147307200003111,0.00146557901916482,0.00144653351219448,24612.3739919135,27019.8829142343,29417.9400305595,30515.2194445154,32339.1649523422,34814.2677146156,36917.0565680300,39542.5389026920,42673.6651580277,45552.5863772221,48628.9400011060,51247.1230682861,54210.0291633986,57284.6055870265,60018.2064046546,62793.5193281488,65585.1762531617,68664.5290875960,72355.3735574562,74764.4785051985,77157.5343182679,80178.7040442904,83430.8322558036,86082.6823785886,88725.9584481199,91358.9979412950,95194.9415991889,98851.8523909200,102397.446510663,105363.043819981,108332.267671659,112064.992065812,115794.563073338,119506.994579312,122961.802210547,126625.440463199,130737.233916318,134800.401162044,138948.378528891,142743.778506381,146636.724977994,150539.032737616,154400.827838194,158564.905110001,162762.472049434,166949.383015786,171461.878883225,178178.829493240,184116.678551673,190066.116726802,196057.181762180,203467.015283692,210555.539406741,217542.018300902,224538.159789329,234391.089320955,243155.372032901,251244.103055441,259303.624575685;0,0.00331181910465208,0.00156052213396960,0.00148940897842222,0.00147139452826332,0.00144722207743311,26386.8623867256,28833.0186581156,31564.4363757590,33686.5592890690,35446.7208646329,37945.1007193082,40384.2015814421,43463.1844858049,46660.9851229867,49837.1808774102,53027.9328346475,55826.3475505561,59058.8292507844,62553.9612420523,65376.7374426098,68130.4428137134,70868.9563233811,74861.1240539149,78868.7493765139,81399.1497393321,84600.6711848554,87801.6584357492,91044.5928503569,93679.4302841580,96297.8854111036,99832.3035941921,103783.398410290,107421.758494253,111059.320536043,114712.750393082,118017.682789688,121727.998172085,125592.310646269,129477.380411108,133339.055629946,137428.150757049,141783.195485035,146284.377449761,150909.842674099,154979.465286622,159073.332085369,163031.200090508,166886.784548354,171033.266333180,175764.969318748,180693.965316841,185637.387446386,193353.679160733,201034.455157098,208404.374871669,214400.986203909,222335.473931252,230287.659810019,238132.161095758,245617.254191107,255481.542676617,266151.156252537,276955.800340589,287727.212501746;0,0.00340581695021792,0.00159771690844571,0.00150763192612539,0.00147981044296089,0.00145072775096565,28543.7825577482,30951.6542335368,33841.0163516920,36134.8893851576,38603.2815777392,41338.2431753410,44028.2856854838,47626.2084990167,50784.4446654759,54086.4277365818,57486.6388927209,60760.7544626638,63966.0498126198,67429.5850101430,70783.5460213282,73938.4185310662,77330.7177780261,81358.9962763618,85386.5369121624,89115.9740196625,92293.4538284507,95478.5653461819,98700.5807203153,101319.344161494,104596.283051353,108502.831569554,112432.570966410,116053.122212655,119673.825169969,123335.781817438,127778.129222441,131668.744572800,135563.094862673,139449.287457161,143837.286661145,148506.276073597,153165.264152819,157803.876309725,162991.028783955,167543.315365802,171718.766337318,175871.320822255,179949.554874988,184826.387080357,189783.227616096,194808.889502504,200592.808056661,209334.019583396,217485.326384513,225296.435908041,233213.090293133,243492.232906320,253539.680322572,262012.960020101,270501.020244690,281936.897612634,293400.863878470,304910.719712182,316216.498813640;0,0.00350167655476838,0.00163593090126336,0.00152766188143456,0.00149031469122411,0.00145625170527464,31150.6632480428,33414.2180894589,36195.4459503020,39031.3031628921,41847.2738405530,45102.4892155363,47747.5580112428,51349.2831991261,54952.7991887461,58533.2564447125,62096.7872526083,65341.8302431291,69147.1355098255,72574.2769527950,76372.0975193216,80468.1331238960,83839.8581821641,87854.2656871648,91875.4722023440,95785.1629879821,99683.8137442799,103206.981639301,106399.182538755,109413.174177052,113333.695916060,117231.958452858,121144.733845803,124745.117732359,128741.011728215,133177.791562178,137611.178084725,141480.656276916,145641.972086754,150060.438335834,154463.565566954,159117.328577939,164072.901404892,169556.163301489,175198.112318565,179868.563292825,184540.423843521,189177.552358930,193711.365520494,199370.607785887,205161.107505288,210954.466270742,216760.768760683,225535.551282833,234336.006481635,243096.069812597,251971.399863407,262530.615892045,273510.457211369,284414.001582998,295339.741097964,307894.671450262,319459.908861935,331082.524028438,342649.200891171;0,0.00359915129855196,0.00167489222305470,0.00154880744250044,0.00150229628779003,0.00146335996678698,33651.6570453664,36089.3535869400,39006.9242237643,42090.8956166101,45132.8465752762,48332.1578390135,51509.8520983511,55322.7566176823,59189.8082230538,62969.6583649696,66749.8218048622,70580.9689013734,74421.3095852618,78204.8653028018,82057.2149034424,86290.5983797796,90393.9763444830,94391.8056723808,98397.2316688665,102298.208086716,106173.966829412,110048.635093229,114096.947195115,118226.117241907,122124.683248848,126008.775369833,129909.476889036,134260.779950356,138647.361637880,143076.508471197,147504.081696682,151893.150770158,156282.770692168,160660.958818902,165193.856881689,170830.575999935,176343.447055554,181880.319106515,187546.034568747,192225.976322188,197072.382065577,202108.054999537,207059.397918600,212621.799253995,218312.378603507,225000.637783986,233104.137758153,244652.520527699,254609.795544730,263807.843767753,273128.129292849,285362.658539550,297259.920721975,308232.061642610,319233.900927912,332257.911666915,345326.485085501,357778.636892667,369440.584022851;0,0.00369806929898855,0.00171455906865739,0.00157106810206013,0.00151555157512605,0.00147171047241455,36200.5077878328,38867.8803645919,41971.2228937181,45275.0591451846,48520.6351341374,51664.0611254379,55374.6146435857,59641.3784280067,63464.2316118971,67211.2620715428,71709.6790145098,75528.9703421327,79871.6451437533,83704.7600141684,87764.1667140221,92328.2523571761,96554.7020620524,100818.178542394,104960.766586408,108935.944542394,113095.843590671,117255.031309235,121467.449654485,125973.649249224,130458.474619375,134791.827812083,138673.687334471,143415.637668499,148158.031876311,152909.926982782,157324.605115682,161726.388584946,166601.711651675,171457.319877190,176288.489194462,182017.673975158,187804.459861396,193696.858017542,199842.603083054,205825.229770488,210559.623275241,215585.817959536,220543.631742031,226495.595056586,234632.814267371,242772.301197534,250924.282193412,262538.096272370,274084.525663060,285443.374137691,294840.743081022,307195.054695739,319591.289803102,331895.726553330,343665.120638654,356829.746838891,370057.057392438,383725.830594889,397579.106125850;0,0.00379836665657174,0.00175479416064716,0.00159403927190635,0.00152975936836169,0.00148109575941787,38796.5239494139,41692.5971623157,49664.0060483390,48693.1035419944,51961.3883273800,55557.2892703205,59286.7555173973,63574.9940878916,67788.7542092604,72204.3447480997,76719.0163491791,81007.7045226104,85381.8309561651,89331.2841146463,93498.1950225036,98270.9211658232,102701.925548329,106955.614750915,111609.008998220,115854.858918817,120088.907207687,124332.526842934,128972.720991654,133482.720115993,137965.266281747,142416.913067189,147451.900901964,152703.586639546,157624.505783773,162428.081672381,167237.111662654,172234.612273092,177223.067482672,182197.466076274,187426.977767761,193663.100453827,199721.191569955,205794.381037292,211977.143982244,217981.517317955,223959.497721140,229870.919596971,236754.593455072,244798.695576428,252977.534948903,261161.385253235,268977.383943812,280647.446185456,292568.825622527,304501.257039914,316539.597952115,330792.621803265,343709.751206904,356492.657485670,369340.760467420,386101.322466697,401546.629816149,416272.844093604,430797.043614493;0,0.00390003991256091,0.00179559021564997,0.00161767733926427,0.00154479245486125,0.00149134632337842,41440.3254389998,44563.6062790333,57446.5861877971,52154.7330715297,55736.7449945138,59511.9556249225,63360.8615414182,68452.1683243532,73058.1218605118,77632.7770907988,82131.9174518495,86487.8676430294,91013.6134117389,95133.0072836904,99269.6384754377,104015.497623849,109145.664480457,113681.398977685,118322.193607004,122541.884843643,127187.132641865,131917.911986265,136704.723812856,141201.366861458,146162.338422958,151186.023046689,156242.383451094,161480.214253485,166718.744127455,171989.764447279,177240.505977570,182533.296326187,187866.328798142,193198.450030181,198529.166997864,205650.590402761,212807.803648741,217991.714275174,224245.148212712,230283.207686105,237402.270069905,244515.862449317,251612.276569630,259742.333201363,268020.491034195,276518.484308290,287404.103088987,300907.190135872,313666.919366257,325796.373872959,338013.041174223,353740.901944163,369679.270431792,383374.281265436,396968.539516973,414117.849067354,430331.849860629,444826.579840255,457399.334500736;0,0.00400254681956490,0.00183681390474190,0.00164211302047971,0.00156314948536736,0.00150647554905995,44233.9639826579,47576.7979444402,65440.3501485887,55750.1256075026,59639.9659737874,70545.3474535149,67746.4959022806,73433.0475451808,78625.9276281740,83260.9853808108,89562.7523701488,93045.1243316666,96938.1214832174,101883.221222013,107521.691132512,111032.959128904,116397.386165218,120855.371898563,125316.563420338,130056.724270759,134772.864293768,139727.182884450,144761.442475494,149995.999296932,155105.163220854,160115.296303389,165160.073749311,170389.280825123,175897.511414803,182047.728711504,188193.404098683,193698.434216958,199070.869401645,204429.315218606,209821.167939073,217029.701380078,224263.560976342,231439.815692107,239998.822324197,247044.035733587,252444.949218848,259635.351580525,266820.626077611,275054.618565318,284331.858813889,295351.391562933,306359.066355988,320070.840134969,333825.923098579,347737.165725064,360924.714570661,377364.951592582,393411.106340859,408240.327329069,419336.172913919,431359.341151086,447030.456637446,463608.495809843,481009.517394667;0,0.00411313675665918,0.00188095751233778,0.00166746088685860,0.00155461732658352,0.00147722357226501,45920.6731441705,49549.4574300844,72158.9914123769,58397.3383583956,62635.6225347881,80582.9854708144,85029.9942316564,82267.4427396369,86925.5911971944,92413.0562421349,98640.2247090426,102083.702365804,106947.425485154,114067.814631780,119620.804916280,122758.489592502,126030.318692833,130546.929449661,135650.312137592,140379.489290792,145091.629518778,149796.743693639,155304.641348096,157879.469603114,163064.416616203,168224.791244143,173375.479947656,179963.507924098,186088.338484990,192217.741916788,198345.855822984,203858.224173866,209435.911760757,214923.874148837,220359.051411679,227564.896213975,235033.583152387,244127.022077855,253248.737948063,260298.623535450,267339.761448970,274430.459566257,281244.751345478,291105.626852916,302246.790350552,313462.115895862,324847.263450662,339658.494667121,354911.716894280,369645.428022253,382235.302562615,397896.628234900,409782.112628825,423376.755726838,437926.234311426,457623.679533725,477738.373267867,496745.561378279,514811.239351406;0,0.00423185853176568,0.00192826625444796,0.00169446189114788,0.00152286184574605,0.00141207841304310,46511.9196768427,50482.6323500517,77394.0997256171,60061.8195305775,64676.3144551352,89316.8117267894,100849.531143052,89987.6428948980,96293.3411222676,100661.956816485,106687.860251659,110523.011288211,116485.449577071,124554.224853210,130880.109214482,134063.174393406,137512.091590541,142007.596753529,148069.682789580,152803.843239262,157540.363677259,163117.588938498,169602.416025826,170230.062752158,170925.177662662,176107.421655187,181205.228844102,188013.363522762,194955.018452456,201783.445919939,207883.156752292,213424.875012500,219083.197071615,224741.210957767,230255.951051467,238361.166005925,247494.254042148,256802.413349248,265893.059591700,272928.957736749,280055.341458542,287887.471802998,299134.508962755,309256.987941296,320936.745245918,332762.399728209,344157.129357579,358259.572086837,371518.603334446,383147.258053124,394088.620626385,411729.321125860,430587.059241904,449022.094182628,464537.662100491,484372.426113031,504185.640003485,531718.647262749,560711.345855159;0,0.00433914523349633,0.00197125025518714,0.00172040803293932,0.00154348491490049,0.00143004867538107,49355.2141193497,53546.0966812220,85413.7995526006,63691.9366320891,68617.2327905391,100360.701039675,119008.192083920,99731.4690207748,107653.758025082,110846.254195348,116667.929579408,121947.373431928,127850.395020899,135871.422986830,143891.958307543,147286.830224108,150685.604439954,156004.335418044,162151.839156889,166851.980714907,172518.037926123,179071.241400528,185536.784422538,186117.915494134,186765.278722664,187408.841321174,190522.853285534,197327.103966622,204128.291696518,210502.047372951,216883.920287089,223387.361301119,231515.025668050,239658.262368596,247744.015492230,254880.008836782,262207.132882382,271358.869954875,280601.472244159,287809.637093164,298890.905956380,310504.450304333,322523.189545757,333282.702552796,342910.980550394,350420.115858967,356608.368734246,370310.882737834,385291.156453679,401134.928731792,416197.956771840,435087.284203251,456781.808922971,480229.446037407,503678.217436313,531404.198798401,557487.069472283,569792.141969299,609907.431463643;0,0.00444909109323498,0.00201539616762528,0.00174746728802719,0.00156292402035723,0.00144550177146971,52173.0626363573,56576.3694604206,93442.7790125032,67323.3504509418,72564.8643207635,111473.737864523,137291.833083496,109506.375320547,119057.629812662,121075.803341741,126669.885783614,133389.218661769,139228.082588254,147201.130532942,156922.435991203,158659.666801157,164418.136158075,170131.504398228,176238.292018877,181950.218742389,188504.537564375,195023.935805218,201434.584373711,201986.002042859,202707.014242404,204903.995715217,207000.579725649,221404.165868904,234811.362655827,243449.527253824,252103.272443961,257345.844758581,262793.210519491,268256.496657505,272962.174912667,273901.836980569,280929.697197121,288117.434714498,295240.277963645,308045.063782456,321189.233740906,333534.793644669,343212.975856893,349860.784577008,356418.985321201,364270.998914042,373606.043169439,393270.995915953,415013.490732475,436705.530723837,458285.177484392,481500.477993160,503705.199783802,511408.248866071,542948.972537624,578625.950168638,611002.545867900,608015.288658493,659299.335935832;0,0.00456196301665696,0.00206052084674832,0.00177491455184002,0.00158296104590932,0.00146145592964955,55030.7891916927,59661.5280772579,101624.081095747,71020.2756151297,76573.7701169191,122734.418039727,155806.123566772,119398.030306714,130582.969865424,131412.598471513,136778.403366695,144945.923863908,150712.633708121,158640.419406038,170075.485942855,170139.585956555,178265.444903388,184371.032344472,190435.067961445,197163.508848978,204609.222879464,211096.010338885,211524.731890020,218553.167628424,224059.678745405,226232.884878352,228284.472383382,242688.741022703,257326.834865059,269863.588101755,275247.719932522,280707.421878418,286616.824724044,297960.953654558,309269.629530698,320334.437146068,321976.206285214,323884.703217212,326398.135800871,331733.485184848,334835.093945437,341966.460343056,351640.722890901,361030.725220841,371605.217479888,382134.673997887,392498.301812721,415745.619812102,460508.300849896,471998.552026022,500667.025215199,528201.486680881,550526.339104835,542409.081120006,582063.798203189,625715.535084181,664400.008323759,646074.084992890,708548.021978930;0,0.00467830887163187,0.00210720999171562,0.00180389766733062,0.00160362524431700,0.00147769276553151,57968.0069826970,62827.1258409549,109960.110756561,74768.6597545334,80635.0565130886,134143.292744481,174560.332489466,129415.746914730,142245.616142384,141874.192489861,147006.137905081,156634.099153812,162327.872398925,170194.144800902,183336.688580340,181703.487563792,192231.731765275,198736.568488395,204748.270494150,212490.325207583,220834.103904680,227294.677846077,221707.256863784,235258.628621086,245578.281860231,247695.486342766,249713.739297934,264161.627610873,280094.512007868,296578.870105433,298703.031777341,304452.272353056,310876.660294152,328236.985191439,346366.386825891,367956.023391209,364697.659712872,361515.647157821,353322.889383505,348011.330355355,343968.423046435,353663.658010517,367112.871087542,377179.935374241,388626.225404636,400032.327723059,411304.136283654,438389.228414032,506530.631943859,507372.513212596,540657.524215374,569700.467150897,589975.358130639,566377.394914263,613765.869776193,664968.363862606,709589.691457681,676411.277931896,749372.020653618;];

EngSpd_rpm=N_T(1);
EngTrq_Nm=N_T(2);
%fuel_cost=interp2d(ICESpeedIndex_rpm,ICETorqueIndex_Nm,ICEFuelMap, EngSpd_rpm, abs(EngTrq_Nm)); %determine fuel power consumption from the fuel map
fuel_cost=interp2d(ICESpeedIndex_rpm,ICETorqueIndex_Nm,Gen_Fuel_Map, EngSpd_rpm, abs(EngTrq_Nm)); %determine fuel power consumption from the fuel map
f=fuel_cost;

end


function [c,ceq]=equality_constraint(x,P_ICE_k)
c=[];
ceq=(x(1)*(pi/30)*x(2))-P_ICE_k;

end

% %2D interpolation 
function val = interp2d(arg1, arg2, arg3, arg4, arg5)

[nrows,ncols] = size(arg3);
    mx = numel(arg1); my = numel(arg2);   
    
    s = 1 + (arg4-arg1(1))/(arg1(end)-arg1(1))*(ncols-1);
    t = 1 + (arg5-arg2(1))/(arg2(end)-arg2(1))*(nrows-1);


% Matrix element indexing
ndx = floor(t)+floor(s-1)*nrows;

s(:) = (s - floor(s));

t(:) = (t - floor(t));

onemt = 1-t;

val =  ( arg3(ndx).*(onemt) + arg3(ndx+1).*t ).*(1-s) + ...
         ( arg3(ndx+nrows).*(onemt) + arg3(ndx+(nrows+1)).*t ).*s;
end
